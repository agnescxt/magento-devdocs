<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>部署过程 | Magento 2 Developer Documentation</title>
	<meta name="description" content="Magento 2 Developer Documentation.
">

	<link rel="stylesheet" href="/assets/css/app.css" />
	<link rel="stylesheet" href="/assets/css/print.css" media="print"/>

	<link rel="stylesheet" href="/common/css/devdocs.css" />

	<script>
  var baseUrl = "";
  var algolia = {
    id : "E642SEDTHL",
    index:  "devdocs",
    key:  "d2d0f33ab73e291ef8d88d8b565e754c"
  };
</script>




	<link rel="canonical" href="http://localhost:4000/guides/v2.3/cloud/reference/discover-deploy.html">

	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">

	<header class="site-header">

		<nav class="site-nav">

  <div class="menu-btn">
    <a id="menu-btn" class="menu-trigger menu-icon" href="#nav-main" aria-haspopup="true" aria-controls="nav-main"></a>
  </div>

  <div class="nav-container">

    <a class="logo" href="/guides/v2.3/">
      <img src="/assets/i/m-logo.svg" alt=""><img src="/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      
<div class="version-switcher dropdown" data-version="2.3">
	<button id="version-switcher-button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Magento 2.3 Pre-release
	</button>

	<ul class="dropdown-menu dropdown-menu-left" aria-labelledby="version-switcher-button">
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.0/cloud/reference/discover-deploy.html">Magento 2.0</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.1/cloud/reference/discover-deploy.html">Magento 2.1</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.2/cloud/reference/discover-deploy.html">Magento 2.2</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.3/cloud/reference/discover-deploy.html">Magento 2.3 Pre-release</a></li>
	
  </ul>

</div>


      <!-- Main Navigation -->
<ul class="nav-main" role="menubar">

  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">部署</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
          <li><a href="/guides/v2.3/install-gde/bk-install-guide.html">安装向导</a></li>
          
          <li><a href="/guides/v2.3/config-guide/bk-config-guide.html">配置手册</a></li>
          
          <li><a href="/guides/v2.3/performance-best-practices/index.html">高效实践</a></li>
          
          <li><a href="/guides/v2.3/migration/bk-migration-guide.html">迁移指引</a></li>
          <li><a href="/guides/v2.3/cloud/bk-cloud.html">上云指引</a></li>
          <li><a href="/magento-release-information.html">版本日志</a></li>
      </ul>
    </div>

  </li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">开发</span>

    <div class="nav-popup" role="menu" aria-hidden="true">

      <div class="nav-section">
        <div class="nav-section-title">服务端</div>
        <ul>
          <li><a href="/guides/v2.3/architecture/bk-architecture.html">架构说明</a></li>
          <li><a href="/guides/v2.3/extension-dev-guide/bk-extension-dev-guide.html">PHP开发文档</a></li>
          <li><a href="/guides/v2.3/ext-best-practices/bk-ext-best-practices.html">扩展开发实践</a></li>
          <li><a href="/guides/v2.3/mrg/intro.html">各模块介绍</a></li>
          <li><a href="/guides/v2.3/coding-standards/bk-coding-standards.html">编码规范</a></li>
          <li><a href="/guides/v2.3/contributor-guide/contributing.html">贡献指引</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">前端</div>
        <ul>
          <li class=""><a href="/guides/v2.3/frontend-dev-guide/bk-frontend-dev-guide.html">前端工程师手册</a></li>
          
          <li><a href="/guides/v2.3/ui_comp_guide/bk-ui_comps.html">UI组件手册</a></li>
          
          <li><a href="/guides/v2.3/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript开发手册</a></li>
          <li><a href="/guides/v2.3/pattern-library/bk-pattern.html">管理面板设计模式及所用库</a></li>
          <li><a href="/guides/v2.3/design-styleguide/bk-styleguide.html">管理面板样式手册</a></li>
          <li><a href="https://magento-research.github.io/pwa-devdocs/">PWA Studios</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title"><abbr>API</abbr></div>
        <ul>
          <li><a href="/guides/v2.3/get-started/bk-get-started-api.html">Web APIs起步</a></li>
          <li><a href="/guides/v2.3/rest/bk-rest.html">REST API参考</a></li>
          <li><a href="/guides/v2.3/soap/bk-soap.html">SOAP API参考</a></li>
          
          <li><a href="/guides/v2.3/graphql/index.html">GraphQL开发者手册(新!)</a></li>
          
          
          <li><a href="/guides/v2.3/marketplace/eqp/api.html">Marketplace EQP API Reference</a></li>
          
        </ul>
      </div>
    </div>

  </li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">测试</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
        <li><a href="/guides/v2.3/test/testing.html">Magento测试手册</a></li>
        
        <li><a href="/guides/v2.3/magento-functional-testing-framework/release-2/introduction.html">功能验收测试(新!)</a></li>
        
        <li><a href="/guides/v2.3/mtf/mtf_introduction.html">功能测试</a></li>
        <li><a href="/guides/v2.3/test/integration/integration_test_execution.html">集成测试</a></li>
        <li><a href="/guides/v2.3/test/js/jasmine.html">JavaScript单元测试</a></li>
        <li><a href="/guides/v2.3/test/unit/unit_test_execution.html">PHP单元测试</a></li>
        <li><a href="/guides/v2.3/get-started/web-api-functional-testing.html">Web API功能测试</a></li>
      </ul>
    </div>

  </li>


  <li class="nav-main-separator"></li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">功能文档</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
          
          <li class="leaf"><a href="/guides/v2.3/advanced-reporting/overview.html">高级报表</a></li>
          
        
        <li class="leaf"><a href="/guides/v2.3/b2b/bk-b2b.html">B2B</a></li>
        
        <li><a href="/guides/v2.3/howdoi/checkout/checkout_overview.html">Checkout</a></li>
        <li><a href="/guides/v2.3/payments-integrations/bk-payments-integrations.html">支付集成</a></li>
        
          <li><a href="/guides/v2.3/extension-dev-guide/staging.html">Staging</a></li>
        
      </ul>
    </div>

  </li>


  <li class="nav-main-item"  tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">指引</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
        <li><a href="/guides/v2.3/howdoi/bk-how-do-i.html">如何</a></li>
        
        <li><a  data-proofer-ignore href="/guides/v2.3/get-started/order-tutorial/order-intro.html">使用EST APIs处理订单</a></li>
        

        <li><a href="/videos/">视频教程</a></li>
      </ul>
    </div>

  </li>

</ul><!-- /.nav-main -->

    </div>

    <div class="search-btn">
      <a class="search-trigger search-icon" href="#"></a>
    </div>

    <form class="quick-search" action="/guides/v2.3/search.html" method="get" novalidate="novalidate">
      <input type="search" name="q" placeholder="Search" />
      <a href="#" class="quick-search-close">&times;</a>
    </form>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>


	</header>

	<div class="global-wrapper">

		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<a href="#" data-proofer-ignore class="toc-toggler">内容表格</a>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title"></h4>
		<div class="collapsible-navigation">
		    <ul>
		    
		    	

<li class="nav-level1  " id="欢迎使用magento企业版(云支持版)">
    

    
    <a href="/guides/v2.3/cloud/bk-cloud.html">欢迎使用Magento企业版(云支持版)</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="订阅和计划">

            

            
            <a href="/guides/v2.3/cloud/basic-information/cloud-plans.html">订阅和计划</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="新手上路任务">

            

            
            <a href="/guides/v2.3/cloud/onboarding/onboarding-tasks.html">新手上路任务</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="architecture">
    

    
    <a href="/guides/v2.3/cloud/architecture/cloud-architecture.html">Architecture</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="架构起步">

            

            
            <a href="/guides/v2.3/cloud/basic-information/starter-architecture.html">架构起步</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="开发和部署工作流起步">

            

            
            <a href="/guides/v2.3/cloud/basic-information/starter-develop-deploy-workflow.html">开发和部署工作流起步</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="pro-architecture">

            

            
            <a href="/guides/v2.3/cloud/architecture/pro-architecture.html">Pro architecture</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="pro-develop-and-deploy-workflow">

            

            
            <a href="/guides/v2.3/cloud/architecture/pro-develop-deploy-workflow.html">Pro develop and deploy workflow</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="pro-architecture-(legacy)">

            

            
            <a href="/guides/v2.3/cloud/architecture/pro-architecture-legacy.html">Pro architecture (legacy)</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="add-staging-and-production-to-pro-projects-ui">

            

            
            <a href="/guides/v2.3/cloud/trouble/pro-env-management.html">Add Staging and Production to Pro projects UI</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="技术和要求">
    

    
    <a href="/guides/v2.3/cloud/requirements/cloud-requirements.html">技术和要求</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="composer">

            

            
            <a href="/guides/v2.3/cloud/reference/cloud-composer.html">Composer</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="magento-cloud-cli">

            

            
            <a href="/guides/v2.3/cloud/reference/cli-ref-topic.html">Magento Cloud CLI</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="git">

            

            
            <a href="/guides/v2.3/cloud/reference/git-integration.html">Git</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="bitbucket集成">

            

            
            <a href="/guides/v2.3/cloud/project/bitbucket-integration.html">Bitbucket集成</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="github集成">

            

            
            <a href="/guides/v2.3/cloud/project/project-integrate-github.html">Github集成</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="ssh和sftp">

            

            
            <a href="/guides/v2.3/cloud/env/environments-ssh.html">SSH和sFTP</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="new-relic-apm">

            

            
            <a href="/guides/v2.3/cloud/project/new-relic.html">New Relic APM</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="blackfire.io">

            

            
            <a href="/guides/v2.3/cloud/project/project-integrate-blackfire.html">Blackfire.io</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="sendgrid">

            

            
            <a href="/guides/v2.3/cloud/project/sendgrid.html">SendGrid</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="本地环境设置">
    

    
    <a href="/guides/v2.3/cloud/access-acct/first-time-setup.html">本地环境设置</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="本地环境设置准备">

            

            
            <a href="/guides/v2.3/cloud/before/before-workspace.html">本地环境设置准备</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="安装magento所需的必要软件">

            

            
            <a href="/guides/v2.3/cloud/before/before-workspace-magento-prereqs.html">安装Magento所需的必要软件</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="启用ssh密钥登录">

            

            
            <a href="/guides/v2.3/cloud/before/before-workspace-ssh.html">启用ssh密钥登录</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="设置magento文件系统所有者">

            

            
            <a href="/guides/v2.3/cloud/before/before-workspace-file-sys-owner.html">设置Magento文件系统所有者</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="克隆并开发项目分支">

            

            
            <a href="/guides/v2.3/cloud/before/before-setup-env-2_clone.html">克隆并开发项目分支</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="安装magento">

            

            
            <a href="/guides/v2.3/cloud/before/before-setup-env-install.html">安装Magento</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="首次部署">

            

            
            <a href="/guides/v2.3/cloud/access-acct/first-time-deploy.html">首次部署</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="可选---安装样本数据">

            

            
            <a href="/guides/v2.3/cloud/howtos/sample-data.html">可选 - 安装样本数据</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="可选---配置xdebug">

            

            
            <a href="/guides/v2.3/cloud/howtos/debug.html">可选 - 配置Xdebug</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="导入现存的代码到项目">
    

    
    <a href="/guides/v2.3/cloud/access-acct/first-time-setup_import-first-steps.html">导入现存的代码到项目</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="prepare-your-existing-magento-commerce-system">

            

            
            <a href="/guides/v2.3/cloud/access-acct/first-time-setup_import-prepare.html">Prepare your existing Magento Commerce system</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="import-magento-commerce-into-magento企业版(云支持版)">

            

            
            <a href="/guides/v2.3/cloud/access-acct/first-time-setup_import-import.html">Import Magento Commerce into Magento企业版(云支持版)</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="配置你的网店">
    

    
    <a href="/guides/v2.3/cloud/configure/configuration-overview.html">配置你的网店</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="网店配置最佳实践">

            

            
            <a href="/guides/v2.3/cloud/configure/configure-best-practices.html">网店配置最佳实践</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="set-up-paypal">

            

            
            <a href="/guides/v2.3/cloud/live/paypal-onboarding.html">Set up PayPal</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="设置magento-b2b">

            

            
            <a href="/guides/v2.3/cloud/configure/setup-b2b.html">设置Magento B2B</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="设置定时任务">

            

            
            <a href="/guides/v2.3/cloud/configure/setup-cron-jobs.html">设置定时任务</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="set-up-multiple-cloud-websites-or-stores">

            

            
            <a href="/guides/v2.3/cloud/project/project-multi-sites.html">Set up multiple Cloud websites or stores</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="install,-manage,-and-upgrade-modules">

            

            
            <a href="/guides/v2.3/cloud/howtos/install-components.html">Install, manage, and upgrade modules</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="安装一个主题">

            

            
            <a href="/guides/v2.3/cloud/howtos/custom-theme.html">安装一个主题</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="快速配置">
    

    
    <a href="/guides/v2.3/cloud/basic-information/cloud-fastly.html">快速配置</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="快速设置">

            

            
            <a href="/guides/v2.3/cloud/access-acct/fastly.html">快速设置</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="快速定制vcl片段">

            

            
            <a href="/guides/v2.3/cloud/configure/cloud-vcl-custom-snippets.html">快速定制VCL片段</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="定制vcl白名单">

            

            
            <a href="/guides/v2.3/cloud/configure/fastly-vcl-whitelist.html">定制VCL白名单</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="定制vcl黑名单">

            

            
            <a href="/guides/v2.3/cloud/configure/fastly-vcl-blacklist.html">定制VCL黑名单</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="vcl自定义延长管理员超时">

            

            
            <a href="/guides/v2.3/cloud/configure/fastly-vcl-extend-timeout.html">VCL自定义延长管理员超时</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="vcl自定义自重向到wordpress">

            

            
            <a href="/guides/v2.3/cloud/configure/fastly-vcl-wordpress.html">VCL自定义自重向到WordPress</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="vcl自定义块坏引用">

            

            
            <a href="/guides/v2.3/cloud/configure/fastly-vcl-badreferer.html">VCL自定义块坏引用</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="快速故障排查">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble_fastly.html">快速故障排查</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="配置环境">
    

    
    <a href="/guides/v2.3/cloud/env/environments.html">配置环境</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="application">

            

            
            <a href="/guides/v2.3/cloud/project/project-conf-files_magento-app.html">Application</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="构建和部署">

            

            
            <a href="/guides/v2.3/cloud/project/magento-env-yaml.html">构建和部署</a>
            

            
            <ul>
                

                
                
                <li class="nav-level3  " id="设置通知">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/setup-notifications.html">设置通知</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="日志处理">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/log-handlers.html">日志处理</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="小向导">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/smart-wizards.html">小向导</a>
                    

                    
                </li>
                
                
            </ul>
            
        </li>
        
        
        
        
        <li class="nav-level2  " id="环境变量">

            

            
            <a href="/guides/v2.3/cloud/env/variables-intro.html">环境变量</a>
            

            
            <ul>
                

                
                
                <li class="nav-level3  " id="应用程序变量">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/environment-vars_magento.html">应用程序变量</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="构建变量">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/variables-build.html">构建变量</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="云变量">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/variables-cloud.html">云变量</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="deploy-variables">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/variables-deploy.html">Deploy variables</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="部署后变量">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/variables-post-deploy.html">部署后变量</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="在变量下工作">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/working-with-variables.html">在变量下工作</a>
                    

                    
                </li>
                
                
            </ul>
            
        </li>
        
        
        
        
        <li class="nav-level2  " id="routes">

            

            
            <a href="/guides/v2.3/cloud/project/project-conf-files_routes.html">Routes</a>
            

            
            <ul>
                

                
                
                <li class="nav-level3  " id="caching">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-routes-more-cache.html">Caching</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="redirects">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-routes-more-redir.html">Redirects</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="服务端引入">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-routes-more-ssi.html">服务端引入</a>
                    

                    
                </li>
                
                
            </ul>
            
        </li>
        
        
        
        
        <li class="nav-level2  " id="services">

            

            
            <a href="/guides/v2.3/cloud/project/project-conf-files_services.html">Services</a>
            

            
            <ul>
                

                
                
                <li class="nav-level3  " id="设置mysql服务">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-conf-files_services-mysql.html">设置MySQL服务</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="设置redis服务">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-conf-files_services-redis.html">设置Redis服务</a>
                    

                    
                </li>
                
                

                
                

                
                
                <li class="nav-level3  " id="设置elasticsearch服务">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-conf-files_services-elastic.html">设置Elasticsearch服务</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="设置rabbitmq服务">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-conf-files_services-rabbit.html">设置RabbitMQ服务</a>
                    

                    
                </li>
                
                
            </ul>
            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="网店设置的配置管理">
    

    
    <a href="/guides/v2.3/cloud/live/sens-data-over.html">网店设置的配置管理</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="管理系统特定配置的示例">

            

            
            <a href="/guides/v2.3/cloud/live/sens-data-initial.html">管理系统特定配置的示例</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="管理你的项目">
    

    
    <a href="/guides/v2.3/cloud/project/projects.html">管理你的项目</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="配置你的项目">

            

            
            <a href="/guides/v2.3/cloud/project/project-webint-basic.html">配置你的项目</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="项目结构">

            

            
            <a href="/guides/v2.3/cloud/project/project-start.html">项目结构</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="创建和管理用户">

            

            
            <a href="/guides/v2.3/cloud/project/user-admin.html">创建和管理用户</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="manage-branches-with-the-interface">

            

            
            <a href="/guides/v2.3/cloud/project/project-webint-branch.html">Manage branches with the Interface</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="使用命令行管理分支">

            

            
            <a href="/guides/v2.3/cloud/env/environments-start.html">使用命令行管理分支</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="快照和备份管理">

            

            
            <a href="/guides/v2.3/cloud/project/project-webint-snap.html">快照和备份管理</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="部署你的网店">
    

    
    <a href="/guides/v2.3/cloud/live/stage-prod-live.html">部署你的网店</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2 active " id="部署过程">

            

            
            <a href="/guides/v2.3/cloud/reference/discover-deploy.html">部署过程</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="continuous-deployment">

            

            
            <a href="/guides/v2.3/cloud/deploy/continuous-deployment.html">Continuous deployment</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="保护块">

            

            
            <a href="/guides/v2.3/cloud/live/live-prot.html">保护块</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="在本地构建和部署">

            

            
            <a href="/guides/v2.3/cloud/live/live-sanity-check.html">在本地构建和部署</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="准备部署准生产和生产环境">

            

            
            <a href="/guides/v2.3/cloud/live/stage-prod-migrate-prereq.html">准备部署准生产和生产环境</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="部署代码并迁移静态文件和数据">

            

            
            <a href="/guides/v2.3/cloud/live/stage-prod-migrate.html">部署代码并迁移静态文件和数据</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="测试部署">

            

            
            <a href="/guides/v2.3/cloud/live/stage-prod-test.html">测试部署</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="上线和发布">
    

    
    <a href="/guides/v2.3/cloud/live/live.html">上线和发布</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="上线检查">

            

            
            <a href="/guides/v2.3/cloud/live/go-live-checklist.html">上线检查</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="发布步骤">

            

            
            <a href="/guides/v2.3/cloud/live/launch-steps.html">发布步骤</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="故障排除">
    

    
    <a href="/guides/v2.3/cloud/trouble/trouble.html">故障排除</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="部署故障排查">

            

            
            <a href="/guides/v2.3/cloud/access-acct/trouble.html">部署故障排查</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="查看日志排查故障">

            

            
            <a href="/guides/v2.3/cloud/trouble/environments-logs.html">查看日志排查故障</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="证书不正确">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble_ce-creds.html">证书不正确</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="新项目的问题解决">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble_proj-startover.html">新项目的问题解决</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="组件部署失败">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble_comp-deploy-fail.html">组件部署失败</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="redis问题排查">

            

            
            <a href="/guides/v2.3/cloud/trouble/redis-troubleshooting.html">Redis问题排查</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="重置定时任务">

            

            
            <a href="/guides/v2.3/cloud/trouble/reset-cron-jobs.html">重置定时任务</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="解决加密密钥问题">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble-crypt-key-variable.html">解决加密密钥问题</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="解决html最小化问题">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble-error-html-minification.html">解决HTML最小化问题</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="解决部署期间的google分析问题">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble-google-analytics-deploy.html">解决部署期间的google分析问题</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="恢复配置文件">

            

            
            <a href="/guides/v2.3/cloud/trouble/restore-configuration-files.html">恢复配置文件</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="站点可用性">

            

            
            <a href="/guides/v2.3/cloud/trouble/site-availability.html">站点可用性</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="添加站点地图和搜索引擎的robots文件">

            

            
            <a href="/guides/v2.3/cloud/trouble/robots-sitemap.html">添加站点地图和搜索引擎的robots文件</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="主题问题排查">

            

            
            <a href="/guides/v2.3/cloud/trouble/theme-troubleshooting.html">主题问题排查</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="消息队列">

            

            
            <a href="/guides/v2.3/cloud/trouble/message-queues.html">消息队列</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="升级和补丁">
    

    
    <a href="/guides/v2.3/cloud/project/project-upgrade-parent.html">升级和补丁</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="patch-cloud工具">

            

            
            <a href="/guides/v2.3/cloud/composer-packages/ece-tools.html">Patch Cloud工具</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="magento企业版(云支持版)补丁">

            

            
            <a href="/guides/v2.3/cloud/project/project-patch.html">Magento企业版(云支持版)补丁</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="magento企业版(云支持版)升级">

            

            
            <a href="/guides/v2.3/cloud/project/project-upgrade.html">Magento企业版(云支持版)升级</a>
            

            
        </li>
        
        
        
        
    </ul>
    
</li>


		    
		    </ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">
	

  <nav class="breadcrumbs">

    <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      <li class="breadcrumb-item"><a class="breadcrumb-item" href="/guides/v2.3/"><span>首页</span></a></li>

    <!-- Iteration breadcrumb item -->
    
    

    

      <!-- Skip if root -->
      

      <!-- Get breadcrumb title -->
      

      <!-- SEO data -->
      

      <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">

        
          <a property="item" typeof="WebPage" href="/guides/v2.3/cloud/bk-cloud.html">
            <span property="name">欢迎使用Magento企业版(云支持版)</span>
          </a>
        

        <meta property="position" content="1" />
      </li>

    

      <!-- Skip if root -->
      

      <!-- Get breadcrumb title -->
      

      <!-- SEO data -->
      

      <li class="breadcrumb-item active" property="itemListElement" typeof="ListItem">

        

          

          <span property="name">部署过程</span>

        

        <meta property="position" content="2" />
      </li>

    

    </ol>

  </nav>



	

	

	<h1 class="page-heading">部署过程</h1>

  


</section>

			<p>Every time you push code from your local workstation to the remote environment or merge code to a base environment branch, such as a merge from the Integration environment to the Staging environment, this activates the build and deploy scripts. These scripts generate new Magento code and provision configured services to the remote environment.</p>

<p>The build and deploy process is slightly different for each plan:</p>

<ul>
  <li><strong>Starter plans</strong>—For the Integration environment, every active branch build and deploys to a full environment for access and testing. Fully test your code after merging to the <code class="highlighter-rouge">staging</code> branch. To go live, push <code class="highlighter-rouge">staging</code> to <code class="highlighter-rouge">master</code> to deploy to Production. You have full access to all branches through the Project Web Interface and the CLI commands.</li>
  <li><strong>Pro plans</strong>—For the Integration environment, every <em>active</em> branch builds and deploys to a full environment for access and testing. You must merge your code to the <code class="highlighter-rouge">integration</code> branch before you can merge to the Staging environment and then the Production environment. You can only merge to Staging and Production using CLI commands with SSH or using the Project Web Interface. If you do not see the Staging or Production environments in your Project Web Interface, then you need to <a href="/guides/v2.3/cloud/trouble/pro-env-management.html">Add Staging and Production to Pro projects UI</a>.</li>
</ul>

<div class="bs-callout bs-callout-info" id="info">
  <p>Verify the code for your site and stores is in the Magento企业版(云支持版) branch. If you point, or include hooks, to code in other branches, such as a private branch, you may encounter problems with the build and deploy process. For example, if you include a theme from a private repo in your branch, the theme will not build with the Magento code.</p>
</div>

<div>

  <div class="bs-callout bs-callout-info" id="info">
    <p><strong>Updating your Pro project</strong>: These sections include instructions for Pro projects with Staging and Production available in the Project Web Interface. To add Staging and Production to your interface, see <a href="/guides/v2.3/cloud/trouble/pro-env-management.html">Add Staging and Production to Pro projects UI</a>.</p>

    <p>We can update Pro projects created before October 23, 2017. All new Pro projects include these features. Your ticket will be queued for update, which may take time to complete. We will keep you updated through the process.</p>

    <p>If you do not request this update, you must use CLI commands or tickets to modify settings, variables, routes, and more for Pro plan Staging and Production environments.</p>
  </div>

  <h2 id="track">Track the process</h2>
  <p>You can track build and deploy actions in real-time using the terminal or the Project Web Interface. The status displays in-progress, pending, success, or failed. You can view the logs in the interface.</p>

  <p>If you are using external GitHub repositories, the log of the operations does not display in the GitHub session. You can still follow activity in their interface and in the Magento企业版(云支持版) Project Web Interface.</p>

  <h2 id="cloud-deploy-conf">Project configuration</h2>
  <p>A set of YAML configuration files located in the project root directory define your Magento installation and describe its dependencies. If you intend to make changes, modify the YAML files in your local branch. The build and deploy scripts access those files for specific settings.</p>

  <p>For all Starter environments and Pro Integration environments, pushing your Git branch updates all settings and configurations dependent on these files.</p>

  <ul>
    <li><a href="/guides/v2.3/cloud/project/project-conf-files_magento-app.html"><code class="highlighter-rouge">.magento.app.yaml</code></a>—defines how to build and deploy Magento, including services, hooks, cron jobs, and more.</li>
    <li><a href="/guides/v2.3/cloud/project/magento-env-yaml.html"><code class="highlighter-rouge">.magento.env.yaml</code></a>—centralizes the management of build and deploy actions across all of your environments, including Pro Staging and Production, using environment variables.</li>
    <li><a href="/guides/v2.3/cloud/project/project-conf-files_routes.html"><code class="highlighter-rouge">.magento/routes.yaml</code></a>—defines how Magento processes an incoming URL.</li>
    <li><a href="/guides/v2.3/cloud/project/project-conf-files_services.html"><code class="highlighter-rouge">.magento/services.yaml</code></a>—defines the services Magento uses by name and version. For example, this file may include versions of MySQL, PHP extensions, and Elasticsearch. These are referred to as <em>services</em>.</li>
    <li>
      <p><a href="http://devdocs.magento.com/guides/v2.2/cloud/live/sens-data-over.html"><code class="highlighter-rouge">app/etc/config.php</code></a>—defines the <a href="http://devdocs.magento.com/guides/v2.2/cloud/live/sens-data-over.html#cloud-clp-settings">system-specific settings</a> Magento uses to configure your store. Magento auto-generates this file if it does not detect it during the build phase and includes a list of modules and extensions. If the file exists, the build phase continues as normal, compresses static files using <code class="highlighter-rouge">gzip</code>, and deploys the files. If you follow <a href="http://devdocs.magento.com/guides/v2.2/cloud/live/sens-data-over.html">Configuration Management</a> at a later time, the commands update the file without requiring additional steps.</p>

      <div class="bs-callout bs-callout-info" id="info">
        <p>The <code class="highlighter-rouge">app/etc/config.php</code> file includes a <em>scopes</em> setting that defines how static files deploy during the build phase. By default, the scope is <a href="http://devdocs.magento.com/guides/v2.2/config-guide/cli/config-cli-subcommands-static-deploy-strategies.html#static-file-quick">quick</a>. Static file deployment takes a long time to complete, so doing it during the build phase reduces deployment and site downtime.</p>
      </div>
    </li>
  </ul>

  <h2 id="requiredfiles">Required files for your Git branch</h2>
  <p>Your Git branch must have the following files for building and deploying in your local environment and to Integration, Staging, and Production environments:</p>

  <ul>
    <li><code class="highlighter-rouge">auth.json</code>—in the root Magento directory. This file includes the Magento Authentication keys entered when creating the project. The file is generated as part of autoprovisioning a new project using a blank template. If you need to verify the file and settings, see <a href="/guides/v2.3/cloud/access-acct/trouble.html">部署故障排查</a>.</li>
    <li><a href="http://devdocs.magento.com/guides/v2.2/cloud/live/sens-data-over.html"><code class="highlighter-rouge">app/etc/config.php</code></a>—auto-generates during the build phase if it does not exist.</li>
    <li><a href="/guides/v2.3/cloud/project/project-conf-files_magento-app.html"><code class="highlighter-rouge">.magento.app.yaml</code></a>—updates and saves to the root directory.</li>
    <li><a href="/guides/v2.3/cloud/project/project-conf-files_services.html"><code class="highlighter-rouge">.magento/services.yaml</code></a>—updates and saves <code class="highlighter-rouge">magento/</code>.</li>
    <li><a href="/guides/v2.3/cloud/project/project-conf-files_routes.html"><code class="highlighter-rouge">.magento/routes.yaml</code></a>—updates and saves to <code class="highlighter-rouge">magento/</code>.</li>
  </ul>

  <h2 id="best-practices">Best practices for builds and deployment</h2>
  <p>We highly recommend the following best practices and considerations for your deployment process:</p>

  <ul>
    <li><strong>Always follow the deployment process</strong> to ensure your code is THE SAME in Integration, Staging, and Production. This is vital. Pushing code from Integration environments may become important or needed for upgrades, patches, and configurations. This deployment overwrites Production and any differences in code in that environment.</li>
    <li><strong>Always add new extensions, integrations, and code in iterated branches</strong> to then build and deploy using the process. Some extensions and integrations must be enabled and configured in a specific order due to dependencies. Adding these in groups can make your build and deploy process much easier and help determine where issues occur.</li>
    <li><strong>Enter the same variables environment-to-environment.</strong> The values for these <a href="/guides/v2.3/cloud/env/variables-intro.html">variables</a> may differ across environments, but the variables may be required for your code.</li>
    <li><strong>Keep sensitive configuration values and data in environment-specific variables.</strong> This includes an <code class="highlighter-rouge">env.php</code> file, CLI-entered variables, and Project Web Interface-entered variables. The values can differ, but having the variables is important.</li>
    <li><strong>Test your build and deploy locally and in Staging before deploying to Production.</strong> Extensions and custom code work great in development. Some users push to production only to have failures and issues. Staging gives you an opportunity to fully test your code and implementation in a production environment without extended downtime if something goes wrong in Production.</li>
  </ul>

  <h2 id="cloud-deploy-over-phases">Five phases of Integration build and deployment</h2>
  <p>The following phases occur in your local development environment and the Integration environment. For Pro plans, the code is not deployed to the Staging or Production environments in these initial phases. See <a href="/guides/v2.3/cloud/live/stage-prod-migrate.html">Deploy code to Staging and Production</a>.</p>

  <p>Integration build and deployment consists of the following phases:</p>

  <p><a href="#cloud-deploy-over-phases-conf">Phase 1: Configuration validation and code retrieval</a><br />
<a href="#cloud-deploy-over-phases-build">Phase 2: Build</a><br />
<a href="#cloud-deploy-over-phases-slug">Phase 3: Prepare slug</a><br />
<a href="#cloud-deploy-over-phases-slugclus">Phase 4: Deploy slugs and cluster</a><br />
<a href="#cloud-deploy-over-phases-hook">Phase 5: Deployment hooks</a><br />
<a href="#cloud-deploy-over-phases-route">Post-deployment: configure routing</a></p>

  <p>For detailed instructions, see <a href="#steps">构建和部署 full steps</a>.</p>

  <h3 id="cloud-deploy-over-phases-conf">Phase 1: Code and configuration validation</h3>
  <p>When you initially set up a project from a template, we retrieve the code from the <a href="https://github.com/magento/magento-cloud" target="\_blank">the Magento Commerce template</a>. This code repo is cloned to your project as the <code class="highlighter-rouge">master</code> branch.</p>

  <ul>
    <li><strong>For Starter</strong>—<code class="highlighter-rouge">master</code> branch is your Production environment.</li>
    <li><strong>For Pro</strong>—<code class="highlighter-rouge">master</code> begins as origin branch for the Integration environment.</li>
  </ul>

  <p>You should create a branch from <code class="highlighter-rouge">master</code> for your custom code, extensions and modules, and third party integrations. We provide a full Integration environment for testing your code in the cloud.</p>

  <p>When you push your code from your local workspace to the remote repository, a series of checks and code validation completes prior to build and deploy scripts. The built-in Git server checks what you are pushing and makes changes. For example, you may want to add an Elasticsearch instance. The built-in Git server detects this and verifies that the topology of your cluster is modified to your new needs.</p>

  <p>If you have a syntax error in a configuration file, our Git server refuses the push. For details, see <a href="/guides/v2.3/cloud/live/live-prot.html">Protective Block</a>.</p>

  <p>This phase also runs <code class="highlighter-rouge">composer install</code> to retrieve dependencies.</p>

  <h3 id="cloud-deploy-over-phases-build">Phase 2: Build</h3>

  <div class="bs-callout bs-callout-info" id="info">
    <p>During the build phase, the site is not in maintenance mode and will not be brought down if errors or issues occur. We build only what has changed since the last build.</p>
  </div>

  <p>This phase builds the codebase and runs hooks in the <code class="highlighter-rouge">build</code> section of <code class="highlighter-rouge">.magento.app.yaml</code>. The default Magento build hook is the <code class="highlighter-rouge">php ./vendor/bin/m2-ece-build</code> command and performs the following:</p>

  <ul>
    <li>Applies patches located in <code class="highlighter-rouge">vendor/magento/ece-patches</code>, as well as optional, project-specific patches in <code class="highlighter-rouge">m2-hotfixes</code></li>
    <li>Regenerates code and the <span term-uuid="2be50595-c5c7-4b9d-911c-3bf2cd3f7beb" class="glossary-term" data-toggle="popover">依赖注入</span> configuration (that is, the Magento <code class="highlighter-rouge">generated/</code> directory, which includes <code class="highlighter-rouge">generated/code</code> and <code class="highlighter-rouge">generated/metapackage</code>) using <code class="highlighter-rouge">bin/magento setup:di:compile</code>.</li>
    <li>Checks if the <a href="/guides/v2.3/cloud/live/sens-data-over.html"><code class="highlighter-rouge">app/etc/config.php</code></a> file exists in the codebase. Magento auto-generates this file it does not detect it during the build phase and includes a list of modules and extensions. If it exists, the build phase continues as normal, compresses static files using <code class="highlighter-rouge">gzip</code>, and deploys the files, which reduces downtime in the deployment phase. Refer to <a href="http://devdocs.magento.com/guides/v2.2/cloud/env/environment-vars_magento.html#build">Magento build options</a> to learn about customizing or disabling file compression.</li>
  </ul>

  <div class="bs-callout bs-callout-info">
    <p>The <code class="highlighter-rouge">app/etc/config.php</code> file includes a <em>scopes</em> setting that defines how static files deploy during the build phase. By default, the scope is <a href="http://devdocs.magento.com/guides/v2.2/config-guide/cli/config-cli-subcommands-static-deploy-strategies.html#static-file-quick"><code class="highlighter-rouge">quick</code></a>. Static file deployment takes a long time to complete, so initiating it during the build phase helps to reduce deployment and site downtime.</p>
  </div>

  <div class="bs-callout bs-callout-warning">
    <p>At this point, the cluster has not been created yet, so you should not try to connect to a database or assume anything was daemonized.</p>
  </div>

  <p>After the application builds, it is mounted on a <strong>read-only file system</strong>. You can configure specific mount points that are going to be read/write. You cannot FTP to the server and add modules. Instead, you must add code to your local repository and run <code class="highlighter-rouge">git push</code>, which builds and deploys the environment. For the project structure, see <a href="/guides/v2.3/cloud/project/project-start.html#cloud-structure-local">Local project directory structure</a>.</p>

  <h3 id="cloud-deploy-over-phases-slug">Phase 3: Prepare the slug</h3>
  <p>The result of the build phase is a read-only file system referred to as a <em>slug</em>. In this phase, we create an archive and put the slug in permanent storage. The next time you push code, if a service did not change, it uses the slug from the archive.</p>

  <ul>
    <li>Makes continuous integration build faster by reusing unchanged code</li>
    <li>If code changes, updates the slug for the next build to reuse</li>
    <li>Allows for instantaneous reverting of a deployment, if needed</li>
    <li>Includes static files if the <code class="highlighter-rouge">app/etc/config.php</code> file exists in the codebase</li>
  </ul>

  <p>The slug includes all files and folders <strong>excluding the following</strong> mounts configured in <code class="highlighter-rouge">magento.app.yaml</code>:</p>

  <ul>
    <li><code class="highlighter-rouge">"var": "shared:files/var"</code></li>
    <li><code class="highlighter-rouge">"app/etc": "shared:files/etc"</code></li>
    <li><code class="highlighter-rouge">"pub/media": "shared:files/media"</code></li>
    <li><code class="highlighter-rouge">"pub/static": "shared:files/static"</code></li>
  </ul>

  <h3 id="cloud-deploy-over-phases-slugclus">Phase 4: Deploy slugs and cluster</h3>
  <p>Now we provision your applications and all of the <span term-uuid="74d6d228-34bd-4475-a6f8-0c0f4d6d0d61" class="glossary-term" data-toggle="popover">后端</span> services you need:</p>

  <ul>
    <li>Mounts each service in a container (web server, Elasticsearch, RabbitMQ)</li>
    <li>Mounts the read-write file system (mounted on a highly available distributed storage grid)</li>
    <li>Configures the network so Magento services can “see” each other (and only each other)</li>
  </ul>

  <div class="bs-callout bs-callout-info" id="info">
    <p>Make your changes in a Git branch after all build and deployment completes and push again. All environment file systems are <em>read-only</em>. A read-only system guarantees deterministic deployments and dramatically improves your site security because no process can write to the file system. It also works to ensure your code is identical in the Integration, Staging, and Production environments.</p>
  </div>

  <h3 id="cloud-deploy-over-phases-hook">Phase 5: Deployment hooks</h3>
  <div class="bs-callout bs-callout-info" id="info">
    <p>This phase puts the application in maintenance mode until deployment is complete.</p>
  </div>

  <p>The last step runs a deployment script, which you can use to anonymize data in development environments, clear caches, and ping external, continuous integration tools. When this script runs, you have access to all the services in your environment, such as Redis.</p>

  <p>If the <code class="highlighter-rouge">app/etc/config.php</code> file does not exist in the codebase, static files are compressed using <code class="highlighter-rouge">gzip</code> and deployed during this phase. This increases the length of your deploy phase and site maintenance.</p>

  <div class="bs-callout bs-callout-info" id="info">
    <p>Refer to <a href="http://devdocs.magento.com/guides/v2.2/cloud/env/environment-vars_magento.html#deploy">Magento deploy variables</a> to learn about customizing or disabling file compression.</p>
  </div>

  <p>There are two default deploy hooks. The <code class="highlighter-rouge">pre-deploy.php</code> hook completes necessary cleanup and retrieval of resources and code generated in the build hook. The <code class="highlighter-rouge">php ./vendor/bin/m2-ece-deploy</code> hook runs a series of commands and scripts:</p>

  <ul>
    <li>
      <p>If Magento is <strong>not installed</strong>, it installs Magento with <code class="highlighter-rouge">bin/magento setup:install</code>, updates the deployment configuration, <code class="highlighter-rouge">app/etc/env.php</code>, and the database for your specified environment, such as Redis and website URLs. <strong>重要:</strong> When you completed the <a href="/guides/v2.3/cloud/access-acct/first-time-deploy.html">首次部署</a> during setup, Magento Commerce was installed and deployed across all environments.</p>
    </li>
    <li>
      <p>If Magento <strong>is installed</strong>, performs any necessary upgrades. The deployment script runs <a href="/guides/v2.3/install-gde/install/cli/install-cli-subcommands-db-upgr.html"><code class="highlighter-rouge">bin/magento setup:upgrade</code></a> to update the database schema and data (which is necessary after extension or core code updates), and also updates the <a href="/guides/v2.3/config-guide/config/config-php.html">deployment configuration</a>, <code class="highlighter-rouge">app/etc/env.php</code>, and the database for your environment. Finally, the deployment script clears the Magento cache.</p>
    </li>
    <li>
      <p>The script optionally generates static web content using the command <a href="/guides/v2.3/config-guide/cli/config-cli-subcommands-static-view.html"><code class="highlighter-rouge">magento setup:static-content:deploy</code></a>.</p>
    </li>
    <li>
      <p>Uses scopes (<code class="highlighter-rouge">-s</code> flag in build scripts) with a default setting of <code class="highlighter-rouge">quick</code> for static content deployment strategy. You can customize the strategy using the environment variable <a href="http://devdocs.magento.com/guides/v2.2/cloud/env/environment-vars_magento.html"><code class="highlighter-rouge">SCD_STRATEGY</code></a>. For details on these options and features, see <a href="http://devdocs.magento.com/guides/v2.2/config-guide/cli/config-cli-subcommands-static-deploy-strategies.html">静态文件部署策略</a> and the <code class="highlighter-rouge">-s</code> flag for <a href="http://devdocs.magento.com/guides/v2.2/config-guide/cli/config-cli-subcommands-static-view.html">部署静态视图文件</a>.</p>
    </li>
  </ul>

  <div class="bs-callout bs-callout-info" id="info">
  <p>Our deploy script uses the values defined by configuration files in the <code>.magento</code> directory, then the script deletes the directory and its contents. Your local development environment is not affected.</p>
</div>

  <h3 id="cloud-deploy-over-phases-route">Post-deployment: configure routing</h3>
  <p>While the deployment is running, we freeze the incoming traffic at the entry point for 60 seconds. We are now ready to configure routing so your web traffic arrives at your newly created cluster.</p>

  <p>Successful deployment removes the maintenance mode to allow for normal access and creates backup (BAK) files for the <code class="highlighter-rouge">app/etc/env.php</code> and the <code class="highlighter-rouge">app/etc/config.php</code> configuration files.</p>

  <p>If you enabled static content generation using the <code class="highlighter-rouge">SCD_ON_DEMAND</code> variable and you configured the <a href="/guides/v2.3/cloud/project/project-conf-files_magento-app.html#hooks"><code class="highlighter-rouge">post_deploy</code> hook</a>, this clears the cache and pre-loads (warms) the cache <em>after</em> the container begins accepting connections and <em>during</em> normal, incoming traffic.</p>

  <p>To review build and deploy logs, see <a href="/guides/v2.3/cloud/trouble/environments-logs.html">Use logs for troubleshooting</a>.</p>

  <h3 id="steps">构建和部署 full steps</h3>
  <p>With an understanding of the process, we provide the following instructions for build and deploy for your local, Integration, Staging, and finally Production:</p>

  <ul>
    <li><a href="/guides/v2.3/cloud/live/live-sanity-check.html">构建和部署 to your local</a></li>
    <li><a href="/guides/v2.3/cloud/live/stage-prod-migrate-prereq.html">Prepare to deploy</a></li>
    <li><a href="/guides/v2.3/cloud/live/stage-prod-migrate.html">Deploy code and data</a></li>
    <li><a href="/guides/v2.3/cloud/live/stage-prod-test.html">测试部署</a></li>
    <li><a href="/guides/v2.3/cloud/live/live.html">上线和发布</a></li>
  </ul>
</div>

			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

    
  
    
    <div class="github-link">
      <a class="improve-page" href="https://github.com/magento/devdocs/blob/develop/guides/v2.3/cloud/reference/discover-deploy.md" target="_blank">
        去GitHub上编辑
      </a>
    </div>
    
  
    
    <div class="new-issue">
      <a href="https://github.com/magento/devdocs/issues/new?title=Feedback on page: /guides/v2.3/cloud/reference/discover-deploy.html" target="_blank">反馈</a>
    </div>
    
  
  </div>

	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      <ul class="nav footer-links">
  <li><a href="/guides/v2.3/contributor-guide/contributing_docs.html">成为贡献者</a>
  <li><a href="https://magento.github.io/glossary/index.html?audience=developer">术语表</a></li>
  <li><a href="http://magento.com/legal/terms/privacy/">隐私政策</a></li>
  <li><a href="http://magento.com/legal/terms/">服务条款</a></li>
  <li><a href="http://magento.com/legal/licensing/">许可/商标 常见问题</a></li>
  <li><a href="/guides/v2.3/release-notes/bk-release-notes.html">版本日志</a></li>
  <li><a href="/magento-third-party.html">三方许可</a></li>
</ul>

    </div>

		<div class="copyright-date">&copy; 2018 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/assets/js/app.min.js"></script>


<script src="/common/js/devdocs.min.js"></script>




</body>
</html>

