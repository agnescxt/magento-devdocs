<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Magento企业版(云支持版)升级 | Magento 2 Developer Documentation</title>
	<meta name="description" content="Magento 2 Developer Documentation.
">

	<link rel="stylesheet" href="/assets/css/app.css" />
	<link rel="stylesheet" href="/assets/css/print.css" media="print"/>

	<link rel="stylesheet" href="/common/css/devdocs.css" />

	<script>
  var baseUrl = "";
  var algolia = {
    id : "E642SEDTHL",
    index:  "devdocs",
    key:  "d2d0f33ab73e291ef8d88d8b565e754c"
  };
</script>




	<link rel="canonical" href="http://localhost:4000/guides/v2.3/cloud/project/project-upgrade.html">

	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">

	<header class="site-header">

		<nav class="site-nav">

  <div class="menu-btn">
    <a id="menu-btn" class="menu-trigger menu-icon" href="#nav-main" aria-haspopup="true" aria-controls="nav-main"></a>
  </div>

  <div class="nav-container">

    <a class="logo" href="/guides/v2.3/">
      <img src="/assets/i/m-logo.svg" alt=""><img src="/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      
<div class="version-switcher dropdown" data-version="2.3">
	<button id="version-switcher-button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Magento 2.3 Pre-release
	</button>

	<ul class="dropdown-menu dropdown-menu-left" aria-labelledby="version-switcher-button">
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.0/cloud/project/project-upgrade.html">Magento 2.0</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.1/cloud/project/project-upgrade.html">Magento 2.1</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.2/cloud/project/project-upgrade.html">Magento 2.2</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.3/cloud/project/project-upgrade.html">Magento 2.3 Pre-release</a></li>
	
  </ul>

</div>


      <!-- Main Navigation -->
<ul class="nav-main" role="menubar">

  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">部署</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
          <li><a href="/guides/v2.3/install-gde/bk-install-guide.html">安装向导</a></li>
          
          <li><a href="/guides/v2.3/config-guide/bk-config-guide.html">配置手册</a></li>
          
          <li><a href="/guides/v2.3/performance-best-practices/index.html">高效实践</a></li>
          
          <li><a href="/guides/v2.3/migration/bk-migration-guide.html">迁移指引</a></li>
          <li><a href="/guides/v2.3/cloud/bk-cloud.html">上云指引</a></li>
          <li><a href="/magento-release-information.html">版本日志</a></li>
      </ul>
    </div>

  </li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">开发</span>

    <div class="nav-popup" role="menu" aria-hidden="true">

      <div class="nav-section">
        <div class="nav-section-title">服务端</div>
        <ul>
          <li><a href="/guides/v2.3/architecture/bk-architecture.html">架构说明</a></li>
          <li><a href="/guides/v2.3/extension-dev-guide/bk-extension-dev-guide.html">PHP开发文档</a></li>
          <li><a href="/guides/v2.3/ext-best-practices/bk-ext-best-practices.html">扩展开发实践</a></li>
          <li><a href="/guides/v2.3/mrg/intro.html">各模块介绍</a></li>
          <li><a href="/guides/v2.3/coding-standards/bk-coding-standards.html">编码规范</a></li>
          <li><a href="/guides/v2.3/contributor-guide/contributing.html">贡献指引</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">前端</div>
        <ul>
          <li class=""><a href="/guides/v2.3/frontend-dev-guide/bk-frontend-dev-guide.html">前端工程师手册</a></li>
          
          <li><a href="/guides/v2.3/ui_comp_guide/bk-ui_comps.html">UI组件手册</a></li>
          
          <li><a href="/guides/v2.3/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript开发手册</a></li>
          <li><a href="/guides/v2.3/pattern-library/bk-pattern.html">管理面板设计模式及所用库</a></li>
          <li><a href="/guides/v2.3/design-styleguide/bk-styleguide.html">管理面板样式手册</a></li>
          <li><a href="https://magento-research.github.io/pwa-devdocs/">PWA Studios</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title"><abbr>API</abbr></div>
        <ul>
          <li><a href="/guides/v2.3/get-started/bk-get-started-api.html">Web APIs起步</a></li>
          <li><a href="/guides/v2.3/rest/bk-rest.html">REST API参考</a></li>
          <li><a href="/guides/v2.3/soap/bk-soap.html">SOAP API参考</a></li>
          
          <li><a href="/guides/v2.3/graphql/index.html">GraphQL开发者手册(新!)</a></li>
          
          
          <li><a href="/guides/v2.3/marketplace/eqp/api.html">Marketplace EQP API Reference</a></li>
          
        </ul>
      </div>
    </div>

  </li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">测试</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
        <li><a href="/guides/v2.3/test/testing.html">Magento测试手册</a></li>
        
        <li><a href="/guides/v2.3/magento-functional-testing-framework/release-2/introduction.html">功能验收测试(新!)</a></li>
        
        <li><a href="/guides/v2.3/mtf/mtf_introduction.html">功能测试</a></li>
        <li><a href="/guides/v2.3/test/integration/integration_test_execution.html">集成测试</a></li>
        <li><a href="/guides/v2.3/test/js/jasmine.html">JavaScript单元测试</a></li>
        <li><a href="/guides/v2.3/test/unit/unit_test_execution.html">PHP单元测试</a></li>
        <li><a href="/guides/v2.3/get-started/web-api-functional-testing.html">Web API功能测试</a></li>
      </ul>
    </div>

  </li>


  <li class="nav-main-separator"></li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">功能文档</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
          
          <li class="leaf"><a href="/guides/v2.3/advanced-reporting/overview.html">高级报表</a></li>
          
        
        <li class="leaf"><a href="/guides/v2.3/b2b/bk-b2b.html">B2B</a></li>
        
        <li><a href="/guides/v2.3/howdoi/checkout/checkout_overview.html">Checkout</a></li>
        <li><a href="/guides/v2.3/payments-integrations/bk-payments-integrations.html">支付集成</a></li>
        
          <li><a href="/guides/v2.3/extension-dev-guide/staging.html">Staging</a></li>
        
      </ul>
    </div>

  </li>


  <li class="nav-main-item"  tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">指引</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
        <li><a href="/guides/v2.3/howdoi/bk-how-do-i.html">如何</a></li>
        
        <li><a  data-proofer-ignore href="/guides/v2.3/get-started/order-tutorial/order-intro.html">使用EST APIs处理订单</a></li>
        

        <li><a href="/videos/">视频教程</a></li>
      </ul>
    </div>

  </li>

</ul><!-- /.nav-main -->

    </div>

    <div class="search-btn">
      <a class="search-trigger search-icon" href="#"></a>
    </div>

    <form class="quick-search" action="/guides/v2.3/search.html" method="get" novalidate="novalidate">
      <input type="search" name="q" placeholder="Search" />
      <a href="#" class="quick-search-close">&times;</a>
    </form>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>


	</header>

	<div class="global-wrapper">

		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<a href="#" data-proofer-ignore class="toc-toggler">内容表格</a>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title"></h4>
		<div class="collapsible-navigation">
		    <ul>
		    
		    	

<li class="nav-level1  " id="欢迎使用magento企业版(云支持版)">
    

    
    <a href="/guides/v2.3/cloud/bk-cloud.html">欢迎使用Magento企业版(云支持版)</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="订阅和计划">

            

            
            <a href="/guides/v2.3/cloud/basic-information/cloud-plans.html">订阅和计划</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="新手上路任务">

            

            
            <a href="/guides/v2.3/cloud/onboarding/onboarding-tasks.html">新手上路任务</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="architecture">
    

    
    <a href="/guides/v2.3/cloud/architecture/cloud-architecture.html">Architecture</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="架构起步">

            

            
            <a href="/guides/v2.3/cloud/basic-information/starter-architecture.html">架构起步</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="开发和部署工作流起步">

            

            
            <a href="/guides/v2.3/cloud/basic-information/starter-develop-deploy-workflow.html">开发和部署工作流起步</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="pro-architecture">

            

            
            <a href="/guides/v2.3/cloud/architecture/pro-architecture.html">Pro architecture</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="pro-develop-and-deploy-workflow">

            

            
            <a href="/guides/v2.3/cloud/architecture/pro-develop-deploy-workflow.html">Pro develop and deploy workflow</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="pro-architecture-(legacy)">

            

            
            <a href="/guides/v2.3/cloud/architecture/pro-architecture-legacy.html">Pro architecture (legacy)</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="add-staging-and-production-to-pro-projects-ui">

            

            
            <a href="/guides/v2.3/cloud/trouble/pro-env-management.html">Add Staging and Production to Pro projects UI</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="技术和要求">
    

    
    <a href="/guides/v2.3/cloud/requirements/cloud-requirements.html">技术和要求</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="composer">

            

            
            <a href="/guides/v2.3/cloud/reference/cloud-composer.html">Composer</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="magento-cloud-cli">

            

            
            <a href="/guides/v2.3/cloud/reference/cli-ref-topic.html">Magento Cloud CLI</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="git">

            

            
            <a href="/guides/v2.3/cloud/reference/git-integration.html">Git</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="bitbucket集成">

            

            
            <a href="/guides/v2.3/cloud/project/bitbucket-integration.html">Bitbucket集成</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="github集成">

            

            
            <a href="/guides/v2.3/cloud/project/project-integrate-github.html">Github集成</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="ssh和sftp">

            

            
            <a href="/guides/v2.3/cloud/env/environments-ssh.html">SSH和sFTP</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="new-relic-apm">

            

            
            <a href="/guides/v2.3/cloud/project/new-relic.html">New Relic APM</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="blackfire.io">

            

            
            <a href="/guides/v2.3/cloud/project/project-integrate-blackfire.html">Blackfire.io</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="sendgrid">

            

            
            <a href="/guides/v2.3/cloud/project/sendgrid.html">SendGrid</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="本地环境设置">
    

    
    <a href="/guides/v2.3/cloud/access-acct/first-time-setup.html">本地环境设置</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="本地环境设置准备">

            

            
            <a href="/guides/v2.3/cloud/before/before-workspace.html">本地环境设置准备</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="安装magento所需的必要软件">

            

            
            <a href="/guides/v2.3/cloud/before/before-workspace-magento-prereqs.html">安装Magento所需的必要软件</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="启用ssh密钥登录">

            

            
            <a href="/guides/v2.3/cloud/before/before-workspace-ssh.html">启用ssh密钥登录</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="设置magento文件系统所有者">

            

            
            <a href="/guides/v2.3/cloud/before/before-workspace-file-sys-owner.html">设置Magento文件系统所有者</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="克隆并开发项目分支">

            

            
            <a href="/guides/v2.3/cloud/before/before-setup-env-2_clone.html">克隆并开发项目分支</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="安装magento">

            

            
            <a href="/guides/v2.3/cloud/before/before-setup-env-install.html">安装Magento</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="首次部署">

            

            
            <a href="/guides/v2.3/cloud/access-acct/first-time-deploy.html">首次部署</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="可选---安装样本数据">

            

            
            <a href="/guides/v2.3/cloud/howtos/sample-data.html">可选 - 安装样本数据</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="可选---配置xdebug">

            

            
            <a href="/guides/v2.3/cloud/howtos/debug.html">可选 - 配置Xdebug</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="导入现存的代码到项目">
    

    
    <a href="/guides/v2.3/cloud/access-acct/first-time-setup_import-first-steps.html">导入现存的代码到项目</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="prepare-your-existing-magento-commerce-system">

            

            
            <a href="/guides/v2.3/cloud/access-acct/first-time-setup_import-prepare.html">Prepare your existing Magento Commerce system</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="import-magento-commerce-into-magento企业版(云支持版)">

            

            
            <a href="/guides/v2.3/cloud/access-acct/first-time-setup_import-import.html">Import Magento Commerce into Magento企业版(云支持版)</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="配置你的网店">
    

    
    <a href="/guides/v2.3/cloud/configure/configuration-overview.html">配置你的网店</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="网店配置最佳实践">

            

            
            <a href="/guides/v2.3/cloud/configure/configure-best-practices.html">网店配置最佳实践</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="set-up-paypal">

            

            
            <a href="/guides/v2.3/cloud/live/paypal-onboarding.html">Set up PayPal</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="设置magento-b2b">

            

            
            <a href="/guides/v2.3/cloud/configure/setup-b2b.html">设置Magento B2B</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="设置定时任务">

            

            
            <a href="/guides/v2.3/cloud/configure/setup-cron-jobs.html">设置定时任务</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="set-up-multiple-cloud-websites-or-stores">

            

            
            <a href="/guides/v2.3/cloud/project/project-multi-sites.html">Set up multiple Cloud websites or stores</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="install,-manage,-and-upgrade-modules">

            

            
            <a href="/guides/v2.3/cloud/howtos/install-components.html">Install, manage, and upgrade modules</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="安装一个主题">

            

            
            <a href="/guides/v2.3/cloud/howtos/custom-theme.html">安装一个主题</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="快速配置">
    

    
    <a href="/guides/v2.3/cloud/basic-information/cloud-fastly.html">快速配置</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="快速设置">

            

            
            <a href="/guides/v2.3/cloud/access-acct/fastly.html">快速设置</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="快速定制vcl片段">

            

            
            <a href="/guides/v2.3/cloud/configure/cloud-vcl-custom-snippets.html">快速定制VCL片段</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="定制vcl白名单">

            

            
            <a href="/guides/v2.3/cloud/configure/fastly-vcl-whitelist.html">定制VCL白名单</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="定制vcl黑名单">

            

            
            <a href="/guides/v2.3/cloud/configure/fastly-vcl-blacklist.html">定制VCL黑名单</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="vcl自定义延长管理员超时">

            

            
            <a href="/guides/v2.3/cloud/configure/fastly-vcl-extend-timeout.html">VCL自定义延长管理员超时</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="vcl自定义自重向到wordpress">

            

            
            <a href="/guides/v2.3/cloud/configure/fastly-vcl-wordpress.html">VCL自定义自重向到WordPress</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="vcl自定义块坏引用">

            

            
            <a href="/guides/v2.3/cloud/configure/fastly-vcl-badreferer.html">VCL自定义块坏引用</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="快速故障排查">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble_fastly.html">快速故障排查</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="配置环境">
    

    
    <a href="/guides/v2.3/cloud/env/environments.html">配置环境</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="application">

            

            
            <a href="/guides/v2.3/cloud/project/project-conf-files_magento-app.html">Application</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="构建和部署">

            

            
            <a href="/guides/v2.3/cloud/project/magento-env-yaml.html">构建和部署</a>
            

            
            <ul>
                

                
                
                <li class="nav-level3  " id="设置通知">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/setup-notifications.html">设置通知</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="日志处理">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/log-handlers.html">日志处理</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="小向导">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/smart-wizards.html">小向导</a>
                    

                    
                </li>
                
                
            </ul>
            
        </li>
        
        
        
        
        <li class="nav-level2  " id="环境变量">

            

            
            <a href="/guides/v2.3/cloud/env/variables-intro.html">环境变量</a>
            

            
            <ul>
                

                
                
                <li class="nav-level3  " id="应用程序变量">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/environment-vars_magento.html">应用程序变量</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="构建变量">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/variables-build.html">构建变量</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="云变量">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/variables-cloud.html">云变量</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="deploy-variables">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/variables-deploy.html">Deploy variables</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="部署后变量">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/variables-post-deploy.html">部署后变量</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="在变量下工作">
                    

                    
                    <a  href="/guides/v2.3/cloud/env/working-with-variables.html">在变量下工作</a>
                    

                    
                </li>
                
                
            </ul>
            
        </li>
        
        
        
        
        <li class="nav-level2  " id="routes">

            

            
            <a href="/guides/v2.3/cloud/project/project-conf-files_routes.html">Routes</a>
            

            
            <ul>
                

                
                
                <li class="nav-level3  " id="caching">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-routes-more-cache.html">Caching</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="redirects">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-routes-more-redir.html">Redirects</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="服务端引入">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-routes-more-ssi.html">服务端引入</a>
                    

                    
                </li>
                
                
            </ul>
            
        </li>
        
        
        
        
        <li class="nav-level2  " id="services">

            

            
            <a href="/guides/v2.3/cloud/project/project-conf-files_services.html">Services</a>
            

            
            <ul>
                

                
                
                <li class="nav-level3  " id="设置mysql服务">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-conf-files_services-mysql.html">设置MySQL服务</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="设置redis服务">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-conf-files_services-redis.html">设置Redis服务</a>
                    

                    
                </li>
                
                

                
                

                
                
                <li class="nav-level3  " id="设置elasticsearch服务">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-conf-files_services-elastic.html">设置Elasticsearch服务</a>
                    

                    
                </li>
                
                

                
                
                <li class="nav-level3  " id="设置rabbitmq服务">
                    

                    
                    <a  href="/guides/v2.3/cloud/project/project-conf-files_services-rabbit.html">设置RabbitMQ服务</a>
                    

                    
                </li>
                
                
            </ul>
            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="网店设置的配置管理">
    

    
    <a href="/guides/v2.3/cloud/live/sens-data-over.html">网店设置的配置管理</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="管理系统特定配置的示例">

            

            
            <a href="/guides/v2.3/cloud/live/sens-data-initial.html">管理系统特定配置的示例</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="管理你的项目">
    

    
    <a href="/guides/v2.3/cloud/project/projects.html">管理你的项目</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="配置你的项目">

            

            
            <a href="/guides/v2.3/cloud/project/project-webint-basic.html">配置你的项目</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="项目结构">

            

            
            <a href="/guides/v2.3/cloud/project/project-start.html">项目结构</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="创建和管理用户">

            

            
            <a href="/guides/v2.3/cloud/project/user-admin.html">创建和管理用户</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="manage-branches-with-the-interface">

            

            
            <a href="/guides/v2.3/cloud/project/project-webint-branch.html">Manage branches with the Interface</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="使用命令行管理分支">

            

            
            <a href="/guides/v2.3/cloud/env/environments-start.html">使用命令行管理分支</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="快照和备份管理">

            

            
            <a href="/guides/v2.3/cloud/project/project-webint-snap.html">快照和备份管理</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="部署你的网店">
    

    
    <a href="/guides/v2.3/cloud/live/stage-prod-live.html">部署你的网店</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="部署过程">

            

            
            <a href="/guides/v2.3/cloud/reference/discover-deploy.html">部署过程</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="continuous-deployment">

            

            
            <a href="/guides/v2.3/cloud/deploy/continuous-deployment.html">Continuous deployment</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="保护块">

            

            
            <a href="/guides/v2.3/cloud/live/live-prot.html">保护块</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="在本地构建和部署">

            

            
            <a href="/guides/v2.3/cloud/live/live-sanity-check.html">在本地构建和部署</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="准备部署准生产和生产环境">

            

            
            <a href="/guides/v2.3/cloud/live/stage-prod-migrate-prereq.html">准备部署准生产和生产环境</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="部署代码并迁移静态文件和数据">

            

            
            <a href="/guides/v2.3/cloud/live/stage-prod-migrate.html">部署代码并迁移静态文件和数据</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="测试部署">

            

            
            <a href="/guides/v2.3/cloud/live/stage-prod-test.html">测试部署</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="上线和发布">
    

    
    <a href="/guides/v2.3/cloud/live/live.html">上线和发布</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="上线检查">

            

            
            <a href="/guides/v2.3/cloud/live/go-live-checklist.html">上线检查</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="发布步骤">

            

            
            <a href="/guides/v2.3/cloud/live/launch-steps.html">发布步骤</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="故障排除">
    

    
    <a href="/guides/v2.3/cloud/trouble/trouble.html">故障排除</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="部署故障排查">

            

            
            <a href="/guides/v2.3/cloud/access-acct/trouble.html">部署故障排查</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="查看日志排查故障">

            

            
            <a href="/guides/v2.3/cloud/trouble/environments-logs.html">查看日志排查故障</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="证书不正确">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble_ce-creds.html">证书不正确</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="新项目的问题解决">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble_proj-startover.html">新项目的问题解决</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="组件部署失败">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble_comp-deploy-fail.html">组件部署失败</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="redis问题排查">

            

            
            <a href="/guides/v2.3/cloud/trouble/redis-troubleshooting.html">Redis问题排查</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="重置定时任务">

            

            
            <a href="/guides/v2.3/cloud/trouble/reset-cron-jobs.html">重置定时任务</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="解决加密密钥问题">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble-crypt-key-variable.html">解决加密密钥问题</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="解决html最小化问题">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble-error-html-minification.html">解决HTML最小化问题</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="解决部署期间的google分析问题">

            

            
            <a href="/guides/v2.3/cloud/trouble/trouble-google-analytics-deploy.html">解决部署期间的google分析问题</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="恢复配置文件">

            

            
            <a href="/guides/v2.3/cloud/trouble/restore-configuration-files.html">恢复配置文件</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="站点可用性">

            

            
            <a href="/guides/v2.3/cloud/trouble/site-availability.html">站点可用性</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="添加站点地图和搜索引擎的robots文件">

            

            
            <a href="/guides/v2.3/cloud/trouble/robots-sitemap.html">添加站点地图和搜索引擎的robots文件</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="主题问题排查">

            

            
            <a href="/guides/v2.3/cloud/trouble/theme-troubleshooting.html">主题问题排查</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="消息队列">

            

            
            <a href="/guides/v2.3/cloud/trouble/message-queues.html">消息队列</a>
            

            
        </li>
        
        
    </ul>
    
</li>


		    
		    	

<li class="nav-level1  " id="升级和补丁">
    

    
    <a href="/guides/v2.3/cloud/project/project-upgrade-parent.html">升级和补丁</a>
    

    
    <ul>
        
        
        
        <li class="nav-level2  " id="patch-cloud工具">

            

            
            <a href="/guides/v2.3/cloud/composer-packages/ece-tools.html">Patch Cloud工具</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2  " id="magento企业版(云支持版)补丁">

            

            
            <a href="/guides/v2.3/cloud/project/project-patch.html">Magento企业版(云支持版)补丁</a>
            

            
        </li>
        
        
        
        
        <li class="nav-level2 active " id="magento企业版(云支持版)升级">

            

            
            <a href="/guides/v2.3/cloud/project/project-upgrade.html">Magento企业版(云支持版)升级</a>
            

            
        </li>
        
        
        
        
    </ul>
    
</li>


		    
		    </ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">
	

  <nav class="breadcrumbs">

    <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      <li class="breadcrumb-item"><a class="breadcrumb-item" href="/guides/v2.3/"><span>首页</span></a></li>

    <!-- Iteration breadcrumb item -->
    
    

    

      <!-- Skip if root -->
      

      <!-- Get breadcrumb title -->
      

      <!-- SEO data -->
      

      <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">

        
          <a property="item" typeof="WebPage" href="/guides/v2.3/cloud/bk-cloud.html">
            <span property="name">欢迎使用Magento企业版(云支持版)</span>
          </a>
        

        <meta property="position" content="1" />
      </li>

    

      <!-- Skip if root -->
      

      <!-- Get breadcrumb title -->
      

      <!-- SEO data -->
      

      <li class="breadcrumb-item active" property="itemListElement" typeof="ListItem">

        

          

          <span property="name">Magento企业版(云支持版)升级</span>

        

        <meta property="position" content="2" />
      </li>

    

    </ol>

  </nav>



	

	

	<h1 class="page-heading">Magento企业版(云支持版)升级</h1>

  


</section>

			<p>This information details how to upgrade Magento企业版(云支持版) to 2.2.X from any version, and upgrading to new 2.2.X versions.</p>

<p>When you upgrade Magento企业版(云支持版), you also upgrade with patches and available hotfixes as part of the <code class="highlighter-rouge">magento-cloud-metapackage</code>. Make sure you have <code class="highlighter-rouge">auth.json</code> in your project root folder if there isn’t one already.</p>

<p>Our upgrades are Composer driven. For more information on Composer, see <a href="/guides/v2.3/cloud/reference/cloud-composer.html">Composer in Cloud</a>.</p>

<p>When upgrading from 2.0.X or 2.1.X to 2.2.X, please see <a href="#old-version">Upgrade from 2.0.X or 2.1.X</a>. For additional information on the release, see the [Magento企业版(云支持版) 2.2 Release Notes].</p>

<div class="bs-callout bs-callout-warning">
  <p>Always apply and test a patch your local system in an active branch. You can push and test in an Integration environment prior to deploying across all environments.</p>
</div>

<h2 id="upgradepaths">Supported upgrade paths to 2.2</h2>
<p>You can directly upgrade to Magento企业版(云支持版) 2.2 from the following versions:</p>

<ul>
  <li>2.0.X versions: 2.0.14, 2.0.15, 2.0.16</li>
  <li>2.1.X versions: 2.1.7, 2.1.8, 2.1.9</li>
</ul>

<p>We have heavily tested and verified upgrades to 2.2 from the latest three versions of 2.0.X and 2.1.X.</p>

<p>You can attempt to upgrade from any version directly to Magento企业版(云支持版) 2.2. We cannot guarantee the results. For example, you should be able to upgrade from 2.0.10 or 2.1.4 directly to 2.2.</p>

<p>If you prefer a secured and verified upgrade path, you can upgrade to one of the verified and tested versions, then directly upgrade to 2.2. For example, you could upgrade from 2.0.10 to 2.0.14, then upgrade to 2.2.</p>

<p>When upgrading from any version to 2.2, please review the following sections to update your settings, make changes, and upgrade required software prior to upgrading Magento.</p>

<h2 id="old-version">Upgrade from 2.0.X or 2.1.X</h2>
<p>To upgrade from <strong>2.0.X</strong>:</p>

<ul>
  <li><a href="#php">Upgrade your PHP version</a>: v2.2 supports PHP 7.0 and later</li>
  <li><a href="#magento-app-yaml">.magento.app.yaml</a>: Update the file with new settings and required changes for hooks and environment variables</li>
  <li><a href="#variable">Verify or set the ADMIN_EMAIL variable</a>: This variable is required for upgrades and patch to 2.2 and later</li>
  <li><a href="#fastly">Upgrade Fastly</a>: Make sure you are upgraded to the latest supported version of Fastly</li>
</ul>

<p>To upgrade from <strong>2.1.X</strong>:</p>

<ul>
  <li><a href="#php">Upgrade your PHP version</a>: v2.2 supports PHP 7.0 and 7.1</li>
  <li><a href="#config">Configuration Management</a>: Create a new <code class="highlighter-rouge">config.php</code> using the <code class="highlighter-rouge">config.local.php</code> to properly upgrade</li>
  <li><a href="#magento-app-yaml">.magento.app.yaml</a>: Update the file with new settings and required changes for hooks and environment variables</li>
  <li><a href="#variable">Verify or set the ADMIN_EMAIL variable</a>: This variable is required for upgrades and patch to 2.2 and later</li>
  <li><a href="#fastly">Upgrade Fastly</a>: Make sure you are upgraded to the latest supported version of Fastly</li>
  <li><a href="#gitignore">Update .gitignore for new generated directory</a>: With 2.2 and later, changes in generated folder require additions to <code class="highlighter-rouge">.gitignore</code></li>
</ul>

<p>After completing your upgrade, you may also want to <a href="#extensions">Verify and upgrade your extensions</a>.</p>

<h3 id="php">Upgrade your PHP version</h3>
<p>Magento企业版(云支持版) 2.2 supports PHP 7.0 and 7.1. For Pro projects <strong>created before October 23, 2017</strong>, you must open a <a href="/guides/v2.3/cloud/trouble/trouble.html">support ticket</a> to use PHP 7.1 on your Pro Staging and Production environments.</p>

<p>Make sure to upgrade the version of PHP on your local development workspace as well. For more information, see the following:</p>

<ul>
  <li><a href="http://devdocs.magento.com/guides/v2.2/cloud/before/before-workspace-magento-prereqs.html#php">PHP</a> information for your local Magento workspace</li>
  <li><a href="http://php.net/manual/en/migration70.php" target="\_blank">Migrating from PHP 5.6 to PHP 7.0.x</a></li>
  <li><a href="http://devdocs.magento.com/guides/v2.2/install-gde/system-requirements-tech.html#php">Magento 2.2.x技术栈要求</a></li>
</ul>

<h3 id="config">Configuration Management and upgrading</h3>
<p>If you are upgrading from 2.1.4或更新 to 2.2.X and use Configuration Management, you need to migrate <code class="highlighter-rouge">config.local.php</code> to a temporary <code class="highlighter-rouge">config.php</code> file to your Git branch. When you upgrade without having this file prepared, you will encounter an error with a list of steps to complete prior to upgrading.</p>

<p>Previous versions with Configuration Management use a <code class="highlighter-rouge">config.local.php</code> file for Configuration Management. Starting with 2.2.0, <a href="http://devdocs.magento.com/guides/v2.2/cloud/live/sens-data-over.html">Configuration Management</a> uses a different file name of <code class="highlighter-rouge">config.php</code>.</p>

<p>We recommend creating a temporary <code class="highlighter-rouge">config.php</code> file for your Git branch prior to upgrading:</p>

<ol>
  <li>Create a copy of <code class="highlighter-rouge">config.local.php</code> and name it <code class="highlighter-rouge">config.php</code>. You should add this file in the <code class="highlighter-rouge">app/etc</code> folder.</li>
  <li>Git add and commit the file to your branch.</li>
  <li>Push the file to your Integration branch and environment.</li>
  <li>Continue preparing and upgrade to 2.2.X.</li>
</ol>

<p>For more information, see <a href="http://devdocs.magento.com/guides/v2.2/cloud/live/sens-data-over.html#migrate">Migrate config.local.php to config.php</a>.</p>

<p>After you finish upgrading, you can remove <code class="highlighter-rouge">config.php</code> and create a new, complete file. For more information, see <a href="#configphp">Create a new config.php file</a>. This file works exactly as <code class="highlighter-rouge">config.local.php</code>, with additional settings including a list of your enabled modules, additional configurations, and a different name.</p>

<div class="bs-callout bs-callout-warning">
  <p>You can only delete this file to replace it this one time. After generating a correct config.php file, you cannot delete the file to generate a new one. For more information, see <a href="http://devdocs.magento.com/guides/v2.2/cloud/live/sens-data-over.html">Configuration Management and 管道部署</a>.</p>
</div>

<h3 id="magento-app-yaml">Update .magento.app.yaml</h3>
<p>If you are upgrading from 2.0.X or 2.1.X to 2.2.X, you need to also update your <a href="http://devdocs.magento.com/guides/v2.2/cloud/project/project-conf-files_magento-app.html">.magento.app.yaml</a> or you will encounter errors. Magento企业版(云支持版) 2.2.X has new settings in the file.</p>

<ol>
  <li>Locate and edit your <code class="highlighter-rouge">.magento.app.yaml</code> in your Git branch.</li>
  <li>For the PHP version, make sure it is 7.0: <code class="highlighter-rouge">type: php:7.0</code></li>
  <li>
    <p>We have updated our build and deploy hooks. Locate the <code class="highlighter-rouge">hooks</code> section, and update the following:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> hooks:
   # We run build hooks before your application has been packaged.
   build: |
       php ./vendor/bin/m2-ece-build
   # We run deploy hook after your application has been deployed and started.
   deploy: |
       php ./vendor/bin/m2-ece-deploy
</code></pre></div>    </div>
  </li>
  <li>
    <p>Enter the following environment variables to the end of your file:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> variables:
   env:
     CONFIG__DEFAULT__PAYPAL_ONBOARDING__MIDDLEMAN_DOMAIN: 'payment-broker.magento.com'
     CONFIG__STORES__DEFAULT__PAYMENT__BRAINTREE__CHANNEL: 'Magento_Enterprise_Cloud_BT'
     CONFIG__STORES__DEFAULT__PAYPAL__NOTATION_CODE: 'Magento_Enterprise_Cloud'
</code></pre></div>    </div>
  </li>
  <li>
    <p>Save the file.</p>

    <div class="bs-callout bs-callout-info" id="info">
      <p>Do not commit or push changes to your branch yet. You still need to <a href="#verify-changes">Verify other changes</a> and <a href="#upgrade">Complete the upgrade</a>.</p>
    </div>
  </li>
</ol>

<p><strong>For Pro plan merchants:</strong> When you are ready to deploy to Pro Staging and Production environments, you must enter a <a href="/guides/v2.3/cloud/trouble/trouble.html">Support ticket</a> advising you need your hooks updated for Magento企业版(云支持版) 2.2.</p>

<div class="bs-callout bs-callout-warning">
  <p><strong>For Pro:</strong> You may encounter deployment errors for Pro to your Staging and Production environments if the hooks are not updated. Please enter a <a href="/guides/v2.3/cloud/trouble/trouble.html">Support ticket</a> advising you need your hooks updated in Staging and Production for Magento企业版(云支持版) 2.2.</p>
</div>

<h3 id="variable">Verify or set the ADMIN_EMAIL variable</h3>
<p>The environment variable <code class="highlighter-rouge">ADMIN_EMAIL</code> is required for upgrading and patching. This email is used for sending password reset requests and verified during when updating Magento企业版(云支持版). See <a href="/guides/v2.3/cloud/project/project-webint-basic.html#project-conf-env-var">Set environment and project variables</a>.</p>

<h3 id="fastly">Upgrade Fastly</h3>
<p>If you have not upgraded to the latest supported version of Fastly, you should do so. Check <a href="/guides/v2.3/cloud/requirements/cloud-requirements.html#cloud-arch-software">Supported software versions</a> for the latest version of Fastly we recommend. For instructions, see <a href="/guides/v2.3/cloud/access-acct/fastly.html#upgrade">Upgrade Fastly</a>.</p>

<p>If you do not upgrade your Fastly module, you will be missing vitual updates for Fastly and Magento services. You may also need to update the JSON format. This is already included in Fastly module v1.2.33 and later. For full details, see <a href="https://github.com/fastly/fastly-magento2/blob/00f2bf042e5f708a1c3e7f49ae4f0fe71a658a76/Documentation/Guides/MAGENTO-UPGRADES.md" target="\_blank">Fastly upgrade documentation</a>.</p>

<h3 id="gitignore">Update .gitignore for new generated directory</h3>
<p>With Magento企业版(云支持版) 2.2.X, the generated folders <code class="highlighter-rouge">var/generation</code> and <code class="highlighter-rouge">var/di</code> have been moved to a <code class="highlighter-rouge">generated/</code> read-only directory. You should make sure the following lines are in your .gitignore file. If not, please add them and commit the changes with your branch.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/generated/*
!/generated/.htaccess
</code></pre></div></div>

<h2 id="backup-db">Back up the database</h2>

<div>
  <p>We recommend that you first back up the database of the system you are upgrading. Use the following steps to back up your Integration, Staging, and Production environments.</p>

  <p>Back up your Integration environment database and code:</p>

  <ol>
    <li>
      <p>Enter the following command to make a local backup of the remote database:</p>

      <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>magento-cloud db:dump
</code></pre></div>      </div>
    </li>
    <li>
      <p>Enter the following command to back up code and media:</p>

      <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php bin/magento setup:backup --code [--media]
</code></pre></div>      </div>

      <p>You can optionally omit <code class="highlighter-rouge">[--media]</code> if you have a large number of static files that are already in source control.</p>
    </li>
  </ol>

  <p>Back up your Staging or Production environment database before deploying to those environments:</p>

  <ol>
    <li>
      <p><a href="/guides/v2.3/cloud/env/environments-ssh.html">SSH to the server</a>.</p>
    </li>
    <li>
      <p>Enter the following command to create a database dump:</p>

      <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vendor/bin/ece-tools db-dump
</code></pre></div>      </div>
    </li>
  </ol>

  <div class="bs-callout bs-callout-info">
    <ul>
      <li>We recommend putting the application in maintenance mode before doing a database dump in Production environments.</li>
      <li>The command creates an archive in your local project directory called  <code class="highlighter-rouge">dump-&lt;timestamp&gt;.sql.gz</code>. Refer to <a href="http://devdocs.magento.com/guides/v2.2/cloud/project/project-webint-snap.html#db-dump">Snapshot and backup management</a> for more information.</li>
    </ul>
  </div>

  <h2 id="verify-changes">Verify other changes</h2>
  <p>Verify other changes you’re going to submit to source control before you start the upgrade:</p>

  <ol>
    <li>If you haven’t done so already, change to your project root directory.</li>
    <li>
      <p>Enter the following command:</p>

      <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git status
</code></pre></div>      </div>
    </li>
    <li>If there are changes you do <em>not</em> want to submit to source control, branch or stash them now.</li>
  </ol>

  <h2 id="upgrade">Complete the upgrade</h2>

  <ol>
    <li>
      <p>Change to your Magento base directory and enter the following command:</p>

      <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>composer require magento/magento-cloud-metapackage &lt;requiredversion&gt; --no-update
composer update
</code></pre></div>      </div>

      <p>For example, to upgrade to version 2.2:</p>

      <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>composer require magento/magento-cloud-metapackage 2.2.0 --no-update
composer update
</code></pre></div>      </div>
    </li>
    <li>
      <p>Add, commit, and push your changes to initiate a deployment:</p>

      <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add -A
git commit -m "Upgrade"
git push origin &lt;branch name&gt;
</code></pre></div>      </div>

      <p><code class="highlighter-rouge">git add -A</code> is required to add all changed files to source control because of the way Composer marshals base packages. Both <code class="highlighter-rouge">composer install</code> and <code class="highlighter-rouge">composer update</code> marshal files from the base package (that is, <code class="highlighter-rouge">magento/magento2-base</code> and <code class="highlighter-rouge">magento/magento2-ee-base</code>) into the package root.</p>

      <p>The files Composer marshals belong to the new version of Magento, to overwrite the outdated version of those same files. Currently, marshaling is disabled in Magento Commerce, so you must add the marshaled files to source control.</p>
    </li>
    <li>
      <p>Wait for deployment to complete.</p>
    </li>
    <li>
      <p><a href="#upgrade-verify">Verify your upgrade</a>.</p>
    </li>
  </ol>

  <h2 id="upgrade-verify">Verify your upgrade</h2>
  <p>This section discusses how to verify your upgrade and to troubleshoot any issues you might find.</p>

  <p>To verify the upgrade in your integration, staging, or production system:</p>

  <ol>
    <li><a href="/guides/v2.3/cloud/env/environments-ssh.html">SSH to the server</a>.</li>
    <li>
      <p>Enter the following command from your Magento root directory to verify the installed version:</p>

      <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>php bin/magento --version
</code></pre></div>      </div>
    </li>
  </ol>

  <h2 id="configphp">Create a new config.php file</h2>
  <p>After fully upgrading, you need to create an updated <code class="highlighter-rouge">config.php</code> file. You will only complete these instructions once. Complete any additional configuration changes through the Magento Admin in your Integration environment.</p>

  <ol>
    <li>
      <p>Open a terminal on your local and use an SSH command to generate <code class="highlighter-rouge">/app/etc/config.php</code> on the environment:</p>

      <p><code class="highlighter-rouge">ssh &lt;SSH URL&gt; "&lt;Command&gt;"</code></p>

      <p>For example for Pro, to run the <code class="highlighter-rouge">scd-dump</code> on Integration <code class="highlighter-rouge">master</code>:</p>

      <p><code class="highlighter-rouge">ssh itnu84v4m4e5k-master-ouhx5wq@ssh.us.magentosite.cloud "php vendor/bin/m2-ece-scd-dump"</code></p>
    </li>
    <li>
      <p>Transfer <code class="highlighter-rouge">config.php</code> to your local system using <code class="highlighter-rouge">rsync</code>或<code class="highlighter-rouge">scp</code>. You can only add this file to the Git branch through your local.</p>

      <p><code class="highlighter-rouge">rsync &lt;SSH URL&gt;:app/etc/config.php ./app/etc/config.php</code></p>
    </li>
    <li>
      <p>Add and push <code class="highlighter-rouge">config.php</code> to the Git master branch.</p>

      <p><code class="highlighter-rouge">git add app/etc/config.php &amp;&amp; git commit -m "Add system-specific configuration" &amp;&amp; git push origin master</code></p>
    </li>
  </ol>

  <p>An updated file is generated with a module list and configuration settings at <code class="highlighter-rouge">/app/etc/config.php</code>.</p>

  <div class="bs-callout bs-callout-info" id="info">
    <p>重要: For an upgrade, you will delete <code class="highlighter-rouge">config.php</code>. Once this file is added to your code, you should not delete it. If you need to remove or edit settings, you must manually edit the file to make changes.</p>
  </div>

  <h2 id="extensions">Verify and upgrade your extensions</h2>
  <p>You may need to upgrade any third-party extensions and modules that supports v2.2. We recommend working in a new Integration branch with your extensions disabled. Review your third-party extension and module pages in Marketplace or other company sites to verify support for Magento Commerce and Magento企业版(云支持版) v2.2.</p>

  <p>We recommend <a href="/guides/v2.3/cloud/project/project-webint-snap.html#db-dump">backing up your database</a> prior to installing a number of extensions on your local and Integration environments.</p>

  <ol>
    <li>Create a new branch on your local.</li>
    <li>Disable your extensions as needed.</li>
    <li>As available, download extension upgrades.</li>
    <li>Install the upgrade on your local in the Git branch as documented by the third-party documentation.</li>
    <li>Enable and test the extension locally.</li>
    <li>Push the code to test in your Integration environment.</li>
    <li>Push to Staging to test in a pre-production environment.</li>
  </ol>

  <p>Include the extensions in your going live steps to Production only after fully upgrading Production to v2.2. We strongly recommend fully upgrading your Production environment before including upgraded extensions.</p>

  <h3 id="moreextensions">Additional extension upgrades</h3>
  <p>We strongly recommend upgrading your Fastly module to v1.2.33或更新 for Magento企业版(云支持版) 2.2.</p>

  <h2 id="upgrade-verify-tshoot">Troubleshoot your upgrade</h2>
  <p>In some cases, an error similar to the following displays when you try to access your storefront or the Magento Admin in a browser:</p>

  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>There has been an error processing your request
Exception printing is disabled by default for security reasons.
  Error log record number: &lt;error number&gt;
</code></pre></div>  </div>

  <h3 id="view-error-details-on-the-server">View error details on the server</h3>
  <p>To view the error in your integration system, <a href="/guides/v2.3/cloud/env/environments-ssh.html">SSH to the server</a> and enter the following command:</p>

  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi /app/var/report/&lt;error number&gt;
</code></pre></div>  </div>

  <h3 id="resolve-the-error">Resolve the error</h3>
  <p>One possible error occurs when the deployment hook failed, and therefore the database has not yet been fully upgraded. If so, an error similar to the following is displayed:</p>

  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a:4:{i:0;s:433:"Please upgrade your database: Run "bin/magento setup:upgrade" from the Magento root directory.
The following modules are outdated:
Magento_Sales schema: current version - 2.0.2, required version - 2.0.3
</code></pre></div>  </div>

  <p>To resolve the error:</p>

  <ol>
    <li><a href="/guides/v2.3/cloud/env/environments-ssh.html">SSH to the server</a>.</li>
    <li><a href="/guides/v2.3/cloud/trouble/environments-logs.html">Examine the logs</a> to determine the source of the issue.</li>
    <li>
      <p>After you fix the source of the issue, push the change to the server, which causes the upgrade to restart.</p>

      <p>For example, on a local branch, enter the following commands:</p>

      <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add -A &amp;&amp; git commit -m "fixed deployment failure" &amp;&amp; git push origin &lt;branch name&gt;
</code></pre></div>      </div>
    </li>
  </ol>

  <h3 id="deploy-error">Deployment error</h3>
  <p>If you encounter a deployment error to Pro Staging and Production environments, you need to have us update your <code class="highlighter-rouge">.magento.app.yaml</code> hooks. Please enter a <a href="/guides/v2.3/cloud/trouble/trouble.html">Support ticket</a> advising you need your hooks updated in Staging and Production for Magento企业版(云支持版) 2.2.</p>
</div>

			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

    
  
    
    <div class="github-link">
      <a class="improve-page" href="https://github.com/magento/devdocs/blob/develop/guides/v2.3/cloud/project/project-upgrade.md" target="_blank">
        去GitHub上编辑
      </a>
    </div>
    
  
    
    <div class="new-issue">
      <a href="https://github.com/magento/devdocs/issues/new?title=Feedback on page: /guides/v2.3/cloud/project/project-upgrade.html" target="_blank">反馈</a>
    </div>
    
  
  </div>

	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      <ul class="nav footer-links">
  <li><a href="/guides/v2.3/contributor-guide/contributing_docs.html">成为贡献者</a>
  <li><a href="https://magento.github.io/glossary/index.html?audience=developer">术语表</a></li>
  <li><a href="http://magento.com/legal/terms/privacy/">隐私政策</a></li>
  <li><a href="http://magento.com/legal/terms/">服务条款</a></li>
  <li><a href="http://magento.com/legal/licensing/">许可/商标 常见问题</a></li>
  <li><a href="/guides/v2.3/release-notes/bk-release-notes.html">版本日志</a></li>
  <li><a href="/magento-third-party.html">三方许可</a></li>
</ul>

    </div>

		<div class="copyright-date">&copy; 2018 Magento. All rights reserved. translated by <a target="_blank" href="https://www.silksoftware.com">silksoftware co.ltd</a> - <a href="http://haiwera.xyz">Haiwera</a></div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/assets/js/app.min.js"></script>


<script src="/common/js/devdocs.min.js"></script>




</body>
</html>

