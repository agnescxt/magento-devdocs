<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width initial-scale=1" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Render prices on the frontend | Magento 2 Developer Documentation</title>
	<meta name="description" content="Magento 2 Developer Documentation.
">

	<link rel="stylesheet" href="/assets/css/app.css" />
	<link rel="stylesheet" href="/assets/css/print.css" media="print"/>

	<link rel="stylesheet" href="/common/css/devdocs.css" />

	<script>
  var baseUrl = "";
  var algolia = {
    id : "E642SEDTHL",
    index:  "devdocs",
    key:  "d2d0f33ab73e291ef8d88d8b565e754c"
  };
</script>




	<link rel="canonical" href="http://localhost:4000/guides/v2.3/ui_comp_guide/howto/price_rendering.html">

	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://magento.com/favicon.ico">
	<link rel="apple-touch-icon" type="image/png" href="https://magento.com/apple-touch-icon.png">
	<link rel="apple-touch-icon" type="image/png" sizes="57x57" href="https://magento.com/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" type="image/png" sizes="72x72" href="https://magento.com/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://magento.com/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" type="image/png" sizes="114x114" href="https://magento.com/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://magento.com/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" type="image/png" sizes="144x144" href="https://magento.com/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://magento.com/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://magento.com/apple-touch-icon-180x180.png">

</head>
<body class="layout-default">

	<header class="site-header">

		<nav class="site-nav">

  <div class="menu-btn">
    <a id="menu-btn" class="menu-trigger menu-icon" href="#nav-main" aria-haspopup="true" aria-controls="nav-main"></a>
  </div>

  <div class="nav-container">

    <a class="logo" href="/guides/v2.3/">
      <img src="/assets/i/m-logo.svg" alt=""><img src="/assets/i/magento-logo.svg" alt="Magento" class="magento-logo" />
      <span class="site-logo">DevDocs</span>
    </a>

    <div id="nav-main" class="nav-main-wrap" aria-labelledby="menu-btn">
      
<div class="version-switcher dropdown" data-version="2.3">
	<button id="version-switcher-button" class="btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Magento 2.3 Pre-release
	</button>

	<ul class="dropdown-menu dropdown-menu-left" aria-labelledby="version-switcher-button">
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.0/ui_comp_guide/howto/price_rendering.html">Magento 2.0</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.1/ui_comp_guide/howto/price_rendering.html">Magento 2.1</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.2/ui_comp_guide/howto/price_rendering.html">Magento 2.2</a></li>
	
		<li><a class="dropdown-item" data-proofer-ignore href="/guides/v2.3/ui_comp_guide/howto/price_rendering.html">Magento 2.3 Pre-release</a></li>
	
  </ul>

</div>


      <!-- Main Navigation -->
<ul class="nav-main" role="menubar">

  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">部署</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
          <li><a href="/guides/v2.3/install-gde/bk-install-guide.html">安装向导</a></li>
          
          <li><a href="/guides/v2.3/config-guide/bk-config-guide.html">配置手册</a></li>
          
          <li><a href="/guides/v2.3/performance-best-practices/index.html">高效实践</a></li>
          
          <li><a href="/guides/v2.3/migration/bk-migration-guide.html">迁移指引</a></li>
          <li><a href="/guides/v2.3/cloud/bk-cloud.html">上云指引</a></li>
          <li><a href="/magento-release-information.html">版本日志</a></li>
      </ul>
    </div>

  </li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">开发</span>

    <div class="nav-popup" role="menu" aria-hidden="true">

      <div class="nav-section">
        <div class="nav-section-title">服务端</div>
        <ul>
          <li><a href="/guides/v2.3/architecture/bk-architecture.html">架构说明</a></li>
          <li><a href="/guides/v2.3/extension-dev-guide/bk-extension-dev-guide.html">PHP开发文档</a></li>
          <li><a href="/guides/v2.3/ext-best-practices/bk-ext-best-practices.html">扩展开发实践</a></li>
          <li><a href="/guides/v2.3/mrg/intro.html">各模块介绍</a></li>
          <li><a href="/guides/v2.3/coding-standards/bk-coding-standards.html">编码规范</a></li>
          <li><a href="/guides/v2.3/contributor-guide/contributing.html">贡献指引</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">前端</div>
        <ul>
          <li class=""><a href="/guides/v2.3/frontend-dev-guide/bk-frontend-dev-guide.html">前端工程师手册</a></li>
          
          <li><a href="/guides/v2.3/ui_comp_guide/bk-ui_comps.html">UI组件手册</a></li>
          
          <li><a href="/guides/v2.3/javascript-dev-guide/bk-javascript-dev-guide.html">JavaScript开发手册</a></li>
          <li><a href="/guides/v2.3/pattern-library/bk-pattern.html">管理面板设计模式及所用库</a></li>
          <li><a href="/guides/v2.3/design-styleguide/bk-styleguide.html">管理面板样式手册</a></li>
          <li><a href="https://magento-research.github.io/pwa-devdocs/">PWA Studios</a></li>
        </ul>
      </div>

      <div class="nav-section">
        <div class="nav-section-title"><abbr>API</abbr></div>
        <ul>
          <li><a href="/guides/v2.3/get-started/bk-get-started-api.html">Web APIs起步</a></li>
          <li><a href="/guides/v2.3/rest/bk-rest.html">REST API参考</a></li>
          <li><a href="/guides/v2.3/soap/bk-soap.html">SOAP API参考</a></li>
          
          <li><a href="/guides/v2.3/graphql/index.html">GraphQL开发者手册(新!)</a></li>
          
          
          <li><a href="/guides/v2.3/marketplace/eqp/api.html">Marketplace EQP API Reference</a></li>
          
        </ul>
      </div>
    </div>

  </li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">测试</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
        <li><a href="/guides/v2.3/test/testing.html">Magento测试手册</a></li>
        
        <li><a href="/guides/v2.3/magento-functional-testing-framework/release-2/introduction.html">功能验收测试(新!)</a></li>
        
        <li><a href="/guides/v2.3/mtf/mtf_introduction.html">功能测试</a></li>
        <li><a href="/guides/v2.3/test/integration/integration_test_execution.html">集成测试</a></li>
        <li><a href="/guides/v2.3/test/js/jasmine.html">JavaScript单元测试</a></li>
        <li><a href="/guides/v2.3/test/unit/unit_test_execution.html">PHP单元测试</a></li>
        <li><a href="/guides/v2.3/get-started/web-api-functional-testing.html">Web API功能测试</a></li>
      </ul>
    </div>

  </li>


  <li class="nav-main-separator"></li>


  <li class="nav-main-item" tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">功能文档</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
          
          <li class="leaf"><a href="/guides/v2.3/advanced-reporting/overview.html">高级报表</a></li>
          
        
        <li class="leaf"><a href="/guides/v2.3/b2b/bk-b2b.html">B2B</a></li>
        
        <li><a href="/guides/v2.3/howdoi/checkout/checkout_overview.html">Checkout</a></li>
        <li><a href="/guides/v2.3/payments-integrations/bk-payments-integrations.html">支付集成</a></li>
        
          <li><a href="/guides/v2.3/extension-dev-guide/staging.html">Staging</a></li>
        
      </ul>
    </div>

  </li>


  <li class="nav-main-item"  tabindex="0" role="menuitem" aria-haspopup="true">
    <span tabindex="-1">指引</span>

    <div class="nav-popup" role="menu" aria-hidden="true">
      <ul>
        <li><a href="/guides/v2.3/howdoi/bk-how-do-i.html">如何</a></li>
        
        <li><a  data-proofer-ignore href="/guides/v2.3/get-started/order-tutorial/order-intro.html">使用EST APIs处理订单</a></li>
        

        <li><a href="/videos/">视频教程</a></li>
      </ul>
    </div>

  </li>

</ul><!-- /.nav-main -->

    </div>

    <div class="search-btn">
      <a class="search-trigger search-icon" href="#"></a>
    </div>

    <form class="quick-search" action="/guides/v2.3/search.html" method="get" novalidate="novalidate">
      <input type="search" name="q" placeholder="Search" />
      <a href="#" class="quick-search-close">&times;</a>
    </form>

  </div>

</nav><!-- #site-nav -->
<div class="nav-main-fader"></div>


	</header>

	<div class="global-wrapper">

		<div class="main-container">
			<a id="main-content"></a>


<div class="content-container">

	<!-- sidebar -->
<aside class="sidebar">
	<a href="#" data-proofer-ignore class="toc-toggler">内容表格</a>
	<div class="sidebar-wrapper">

		

		<h4 class="guide-title"></h4>
		<div class="collapsible-navigation">
		    <ul>
		    
		    </ul>
		</div>

	</div>

</aside>
<!-- /sidebar -->


	<section class="content">
		<div class="content-wrap">
			<!-- page-header -->
<section class="page-intro">
	

  <nav class="breadcrumbs">

    <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      <li class="breadcrumb-item"><a class="breadcrumb-item" href="/guides/v2.3/"><span>首页</span></a></li>

    <!-- Iteration breadcrumb item -->
    
    

    

      <!-- Skip if root -->
      

      <!-- Get breadcrumb title -->
      

      <!-- SEO data -->
      

      <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">

        
          <a property="item" typeof="WebPage" href="/guides/v2.3/ui_comp_guide/bk-ui_comps.html">
            <span property="name">UI组件概述</span>
          </a>
        

        <meta property="position" content="1" />
      </li>

    

      <!-- Skip if root -->
      

      <!-- Get breadcrumb title -->
      

      <!-- SEO data -->
      

      <li class="breadcrumb-item active" property="itemListElement" typeof="ListItem">

        

          

          <span property="name">Render prices on the frontend</span>

        

        <meta property="position" content="2" />
      </li>

    

    </ol>

  </nav>



	

	

	<h1 class="page-heading">Render prices on the frontend</h1>

  


</section>

			<p>This article shows how templates and UI 组件 work together to render the price for any product listing(e.g. category, widget, etc).</p>

<h2 id="about-magento-price-handling">About Magento price handling</h2>

<p>Magento is able to operate with a variety of prices, taxes, and product types.</p>

<p>The following is a short list of Magento prices:</p>

<ol>
  <li>Special Price.</li>
  <li>Tier Price.</li>
  <li>Grouped Price.</li>
  <li>Minimum price of composite products</li>
  <li>Price range of composite products</li>
  <li>Manufacturer price (MSRP)</li>
</ol>

<p>Magento represents these prices as price types (e.g. final price, minimum price, maximum price, regular price) and are separate from the actual price in the code.
For example, Special Price is represented by the final price type in the code.</p>

<h3 id="magento-taxes-classification">Magento taxes classification</h3>

<p>Magento handles taxes as price adjustments and has 3 generic types of taxes:</p>

<ul>
  <li>Tax</li>
  <li>Fixed Product Tax</li>
  <li>Tax for Fixed Product Tax</li>
</ul>

<p>Applying and rendering taxes is complicated.
A product can have more than one price shown and taxes may or may not apply to all of them.</p>

<p>Example of pricing strategy for bundled products:
<br />
<img src="http://devdocs.magento.com/common/images/bundle_prices.png" alt="" /></p>

<h2 id="how-to-render-prices-with-ui-组件">How to render prices with UI 组件</h2>

<p>For pages such as a product page, use a <a href="/guides/v2.3/ui_comp_guide/components/ui-form.html">form component</a>.</p>

<p>For pages such as a product listing page or widgets, use a <a href="/guides/v2.3/ui_comp_guide/components/ui-listing-grid.html">listing component</a>.</p>

<p>For the purposes of this article, we will use a listing component to render simple products with two types of prices, <strong>regular price</strong> and <strong>special price</strong>, and one type of adjustment, <strong>tax</strong>.</p>

<h3 id="xml-configuration">XML configuration</h3>

<p>The <a href="/guides/v2.3/ui_comp_guide/howto/new_component_declaration.html">XML configuration file</a> for UI 组件 shows the parent-child relationship between different UI 组件 and tells Magento which template files to use when rendering.</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;listing</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">"urn:magento:module:Magento_Ui:etc/ui_configuration.xsd"</span><span class="nt">&gt;</span>
    ...
    <span class="nt">&lt;datasource&gt;</span>
        <span class="c">&lt;!-- 
            DataProvider should retrieve information about product. In our case will be good to retrieve
            formatted prices with currency code, 等... and raw prices.
            So there will be 4 types of prices:
            {
                ...
                final_price: 13,
                regular_price: 28,
                formatted: {
                    final_price: "$ 13",
                    regular_price: "$ 28",
                },
                adjustments: {
                    tax: 12,
                    formatted: {
                        tax: "$ 12"
                    }
                }
                ...
            }
         
        --&gt;</span>
        <span class="nt">&lt;dataProvider</span> <span class="na">class=</span><span class="s">"SomeVendor\SomeModule\Ui\DataProvider\Listing\DataProvider"</span> <span class="na">name=</span><span class="s">"datasource"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;settings&gt;</span>
                <span class="nt">&lt;requestFieldName/&gt;</span>
                <span class="nt">&lt;primaryFieldName/&gt;</span>
            <span class="nt">&lt;/settings&gt;</span>
        <span class="nt">&lt;/dataProvider&gt;</span>
    <span class="nt">&lt;/datasource&gt;</span>
    <span class="nt">&lt;columns</span> <span class="na">name=</span><span class="s">"some_columns"</span> <span class="na">component=</span><span class="s">"SomeVendor_SomeComponent/js/product/list/listing"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- 
            Price columns is composite component (it has children),
            so it should have possibility to create those children by itself.
            
            The structure of prices should be:
                -- Price Box (collection of all prices)
                    --- Price (is responsible for specific price information, also price can hold the collection of adjustments)
                        ---- Adjustment
         --&gt;</span>
        <span class="nt">&lt;column</span> <span class="na">name=</span><span class="s">"price"</span> <span class="na">component=</span><span class="s">"SomeVendor_SomeComponent/js/product/list/columns/price-box"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;argument</span> <span class="na">name=</span><span class="s">"data"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"config"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"renders"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"prices"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                            <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"children"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"special_price"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"label"</span> <span class="na">xsi:type=</span><span class="s">"string"</span> <span class="na">translate=</span><span class="s">"true"</span><span class="nt">&gt;</span>Special Price<span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"component"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>SomeVendor_SomeComponent/js/product/list/columns/final-price<span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"productType"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>simple<span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"bodyTmpl"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>SomeVendor_SomeComponent/product/price/special_price<span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"sortOrder"</span> <span class="na">xsi:type=</span><span class="s">"number"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/item&gt;</span>
                                    <span class="c">&lt;!-- Below the collection of all adjustments is listed --&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"children"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                                        <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"tax"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                                            <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"component"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>SomeVendor_SomeComponent/js/price/adjustment<span class="nt">&lt;/item&gt;</span>
                                        <span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;/item&gt;</span>
                                <span class="nt">&lt;/item&gt;</span>
                                <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"regular_price"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"label"</span> <span class="na">xsi:type=</span><span class="s">"string"</span> <span class="na">translate=</span><span class="s">"true"</span><span class="nt">&gt;</span>Regular Price<span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"component"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>SomeVendor_SomeComponent/js/product/list/columns/final-price<span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"bodyTmpl"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>SomeVendor_SomeComponent/product/price/regular_price<span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"sortOrder"</span> <span class="na">xsi:type=</span><span class="s">"number"</span><span class="nt">&gt;</span>2<span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"productType"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>simple<span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"children"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                                        <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"tax"</span> <span class="na">xsi:type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
                                            <span class="nt">&lt;item</span> <span class="na">name=</span><span class="s">"component"</span> <span class="na">xsi:type=</span><span class="s">"string"</span><span class="nt">&gt;</span>SomeVendor_SomeComponent/js/price/adjustment<span class="nt">&lt;/item&gt;</span>
                                        <span class="nt">&lt;/item&gt;</span>
                                    <span class="nt">&lt;/item&gt;</span>
                                <span class="nt">&lt;/item&gt;</span>
                            <span class="nt">&lt;/item&gt;</span>
                        <span class="nt">&lt;/item&gt;</span>
                    <span class="nt">&lt;/item&gt;</span>
                <span class="nt">&lt;/item&gt;</span>
            <span class="nt">&lt;/argument&gt;</span>
        <span class="nt">&lt;/column&gt;</span>
    <span class="nt">&lt;/columns&gt;</span>
<span class="nt">&lt;/listing&gt;</span></code></pre></figure>

<p>A good example from the Magento codebase is the Catalog module’s <a href="https://github.com/magento/magento2/blob/2.2/app/code/Magento/Catalog/view/frontend/ui_component/widget_recently_viewed.xml" target="_blank"><code class="highlighter-rouge">widget_recently_viewed.xml</code></a> file.</p>

<h3 id="price-box-component">Price box component</h3>

<p>In the following code sample, the <code class="highlighter-rouge">price-box</code> component aggregates and creates the <code class="highlighter-rouge">price</code> 组件 for a specific product.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/**
 * Retrieve array of prices, that should be rendered for specific product
 *
 * @param {Array} row
 * @return {Array}
 */</span>
<span class="nx">getPrices</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">elems</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">elems</span><span class="p">()</span> <span class="p">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">elems</span><span class="p">()</span> <span class="p">:</span> <span class="nx">ko</span><span class="p">.</span><span class="nx">getObservable</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">'elems'</span><span class="p">),</span>
        <span class="nx">result</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">initPrices</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>    
    <span class="nx">result</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">elems</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">elem</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">elem</span><span class="p">.</span><span class="nx">productType</span> <span class="o">===</span> <span class="nx">row</span><span class="p">.</span><span class="nx">productType</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">},</span>

<span class="cm">/**
 * Init dynamic price 组件
 *
 * @param {Array} row
 * @returns {void}
 */</span>
<span class="nx">initPrices</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">prices</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">renders</span><span class="p">.</span><span class="nx">prices</span><span class="p">;</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">sortBy</span><span class="p">(</span><span class="nx">prices</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_comparePrices</span><span class="p">);</span>

    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">prices</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">priceData</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">priceData</span><span class="p">.</span><span class="nx">component</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">priceData</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
        <span class="nx">priceData</span><span class="p">.</span><span class="nx">provider</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">provider</span><span class="p">;</span>
        <span class="nx">priceData</span> <span class="o">=</span> <span class="nx">utils</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">priceData</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span><span class="c1">//convert to format compatible with uiLayout</span>
        <span class="nx">prices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">priceData</span><span class="p">);</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">);</span>

    <span class="nx">layout</span><span class="p">(</span><span class="nx">prices</span><span class="p">);</span> <span class="c1">//layout is service (abstract factory), which create tree of Ui 组件 from JSON</span>
<span class="p">},</span>


<span class="cm">/**
 * Sort callback to compare prices by sort order
 *
 * @param {Number} firstPrice
 * @param {Number} secondPrice
 * @returns {Number}
 * @private
 */</span>
<span class="nx">_comparePrices</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">firstPrice</span><span class="p">,</span> <span class="nx">secondPrice</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">firstPrice</span><span class="p">.</span><span class="nx">sortOrder</span> <span class="o">&lt;</span> <span class="nx">secondPrice</span><span class="p">.</span><span class="nx">sortOrder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">firstPrice</span><span class="p">.</span><span class="nx">sortOrder</span> <span class="o">&gt;</span> <span class="nx">secondPrice</span><span class="p">.</span><span class="nx">sortOrder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>The preceding code sample is based on the Catalog module’s <a href="https://github.com/magento/magento2/blob/2.2/app/code/Magento/Catalog/view/base/web/js/product/list/columns/price-box.js" target="_blank"><code class="highlighter-rouge">price-box</code> component</a>.</p>

<h3 id="price-component">Price component</h3>

<p>In our example, each price is configured to have its own template, but they all share a common price component called <code class="highlighter-rouge">final-price</code>.
This component is defined in the following code sample:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/**
 * Retrieve specific template
 *
 * @returns {String}
 */</span>
<span class="nx">getBody</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">bodyTmpl</span><span class="p">;</span>
<span class="p">},</span>

<span class="cm">/**
 * Check if product has special price.
 *
 * @param {Object} row
 * @return {HTMLElement} special price html
 */</span>
<span class="nx">hasSpecialPrice</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">row</span><span class="p">[</span><span class="s1">'price_info'</span><span class="p">][</span><span class="s1">'regular_price'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nx">row</span><span class="p">[</span><span class="s1">'price_info'</span><span class="p">][</span><span class="s1">'final_price'</span><span class="p">];</span>
<span class="p">},</span>

<span class="cm">/**
 * Get product regular price.
 *
 * @param {Object} row
 * @return {HTMLElement} regular price html
 */</span>
<span class="nx">getRegularPrice</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">row</span><span class="p">[</span><span class="s1">'price_info'</span><span class="p">][</span><span class="s1">'formatted'</span><span class="p">][</span><span class="s1">'regular_price'</span><span class="p">];</span>
<span class="p">},</span>

<span class="cm">/**
 * Get product final price.
 *
 * @param {Object} row
 * @return {HTMLElement} final price html
 */</span>
<span class="nx">getPrice</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">row</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">row</span><span class="p">[</span><span class="s1">'price_info'</span><span class="p">][</span><span class="s1">'formatted'</span><span class="p">][</span><span class="s1">'final_price'</span><span class="p">];</span>
<span class="p">},</span>

<span class="cm">/**
 * Get all price adjustments.
 *
 * @returns {Object}
 */</span>
<span class="nx">getAdjustments</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">adjustments</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">elems</span><span class="p">();</span>

    <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">adjustments</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">adjustment</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">adjustment</span><span class="p">.</span><span class="nx">source</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">source</span><span class="p">;</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">adjustments</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>This code sample is based on the Catalog module’s <a href="https://github.com/magento/magento2/blob/2.2/app/code/Magento/Catalog/view/base/web/js/product/list/columns/final-price.js" target="_blank"><code class="highlighter-rouge">final-price</code> component</a>.</p>

<h3 id="price-template">Price template</h3>

<p>The following code sample is for the special price template.
It calls the <code class="highlighter-rouge">hasSpecialPrice</code> function to check if a special price exists for a product.</p>

<p>If a product has a special price, it calls <code class="highlighter-rouge">getPrice</code> to get the value and renders any adjustments configured for the price.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;if</span> <span class="na">args=</span><span class="s">"isSalable($row()) &amp;&amp; hasSpecialPrice($row())"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"special-price"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"price-container"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;span</span> <span class="na">if=</span><span class="s">"label"</span>
                  <span class="na">class=</span><span class="s">"price-label"</span>
                  <span class="na">text=</span><span class="s">"label"</span><span class="nt">/&gt;</span>

            <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"price-wrapper"</span>
                  <span class="na">css=</span><span class="s">"priceWrapperCssClasses"</span>
                  <span class="na">attr=</span><span class="s">"priceWrapperAttr"</span>
                  <span class="na">data-price-amount=</span><span class="s">""</span>
                  <span class="na">data-price-type=</span><span class="s">"finalPrice"</span>
                  <span class="na">html=</span><span class="s">"getPrice($row())"</span><span class="nt">/&gt;</span>

            <span class="nt">&lt;each</span> <span class="na">args=</span><span class="s">"data: getAdjustments(), as: '$adj'"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;render</span> <span class="na">args=</span><span class="s">"$adj.getBody()"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/each&gt;</span>
        <span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/if&gt;</span></code></pre></figure>

<p>This example is based on the <a href="https://github.com/magento/magento2/blob/2.2/app/code/Magento/Catalog/view/base/web/template/product/price/special_price.html" target="_blank"><code class="highlighter-rouge">special_price.html</code> template file</a> for Magento Catalog.</p>

<h3 id="tax-template">Tax template</h3>

<p>The following is sample template code that is rendered for the tax adjustment component:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;if</span> <span class="na">args=</span><span class="s">"displayBothPrices()"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"price-wrapper price-excluding-tax"</span>
          <span class="na">attr=</span><span class="s">"'data-label': $t('Excl. Tax')"</span>
          <span class="na">data-price-amount=</span><span class="s">""</span>
          <span class="na">data-price-type=</span><span class="s">"basePrice"</span>
          <span class="na">html=</span><span class="s">"getTax($row())"</span><span class="nt">&gt;</span><span class="c">&lt;!-- You can implement self::getTax function how you want --&gt;</span>
    <span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/if&gt;</span></code></pre></figure>

<h2 id="related-topics">Related Topics</h2>

<ul>
  <li><a href="/guides/v2.3/ui_comp_guide/components/ui-form.html">表单组件</a></li>
  <li><a href="/guides/v2.3/ui_comp_guide/components/ui-listing-grid.html">Listing component</a></li>
  <li><a href="/guides/v2.3/ui_comp_guide/howto/new_component_declaration.html">Declaring UI 组件</a></li>
</ul>


			
		</div>
		<!-- /.content-wrap -->

		<div class="page-info">

    
  
    
    <div class="github-link">
      <a class="improve-page" href="https://github.com/magento/devdocs/blob/develop/guides/v2.3/ui_comp_guide/howto/price_rendering.md" target="_blank">
        去GitHub上编辑
      </a>
    </div>
    
  
    
    <div class="new-issue">
      <a href="https://github.com/magento/devdocs/issues/new?title=Feedback on page: /guides/v2.3/ui_comp_guide/howto/price_rendering.html" target="_blank">反馈</a>
    </div>
    
  
  </div>

	</section>
	<!-- /.content -->

</div> <!-- /.content-container -->


	</div>
	<!-- /.main-container -->
</div>
<!-- /#gl-wrapper -->

<!-- footer-->
<div class="page-footer">
  <div class="container">

    <div class="copyright-links">
      <ul class="nav footer-links">
  <li><a href="/guides/v2.3/contributor-guide/contributing_docs.html">成为贡献者</a>
  <li><a href="https://magento.github.io/glossary/index.html?audience=developer">术语表</a></li>
  <li><a href="http://magento.com/legal/terms/privacy/">隐私政策</a></li>
  <li><a href="http://magento.com/legal/terms/">服务条款</a></li>
  <li><a href="http://magento.com/legal/licensing/">许可/商标 常见问题</a></li>
  <li><a href="/guides/v2.3/release-notes/bk-release-notes.html">版本日志</a></li>
  <li><a href="/magento-third-party.html">三方许可</a></li>
</ul>

    </div>

		<div class="copyright-date">&copy; 2018 Magento. All rights reserved.</div>

  </div>
</div>
<!-- / #footer -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="/assets/js/app.min.js"></script>


<script src="/common/js/devdocs.min.js"></script>




</body>
</html>

